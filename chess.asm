; -----------------------------------------------------------------------------------------------
;################################################################################################
; -----------------------------------------------------------------------------------------------
dseg segment 
	pawn	db  60,0ffh 
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  29,2,0,0,29,0ffh
			db  27,6,0,0,27,0ffh
			db  26,2,4,0,0,2,0,0,26,0ffh
			db  25,2,6,0,0,2,0,0,25,0ffh
			db  25,2,6,0,0,2,0,0,25,0ffh
			db  25,2,6,0,0,2,0,0,25,0ffh
			db  25,2,6,0,0,2,0,0,25,0ffh
			db  25,2,6,0,0,2,0,0,25,0ffh
			db  26,2,4,0,0,2,0,0,26,0ffh
			db  26,2,4,0,0,2,0,0,26,0ffh
			db  25,3,4,0,0,3,0,0,25,0ffh
			db  23,4,6,0,0,4,0,0,23,0ffh
			db  22,2,12,0,0,2,0,0,22,0ffh
			db  21,2,14,0,0,2,0,0,21,0ffh
			db  21,1,16,0,0,1,0,0,21,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  21,1,16,0,0,1,0,0,21,0ffh
			db  21,2,14,0,0,2,0,0,21,0ffh
			db  22,2,12,0,0,2,0,0,22,0ffh
			db  23,2,10,0,0,2,0,0,23,0ffh
			db  23,3,8,0,0,3,0,0,23,0ffh
			db  22,3,10,0,0,3,0,0,22,0ffh
			db  21,3,12,0,0,3,0,0,21,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  19,2,18,0,0,2,0,0,19,0ffh
			db  18,2,20,0,0,2,0,0,18,0ffh
			db  17,2,22,0,0,2,0,0,17,0ffh
			db  16,2,24,0,0,2,0,0,16,0ffh
			db  16,2,24,0,0,2,0,0,16,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  15,1,28,0,0,1,0,0,15,0ffh
			db  14,2,28,0,0,2,0,0,14,0ffh
			db  14,2,28,0,0,2,0,0,14,0ffh
			db  14,2,28,0,0,2,0,0,14,0ffh
			db  14,2,28,0,0,2,0,0,14,0ffh
			db  14,2,28,0,0,2,0,0,14,0ffh
			db  14,2,28,0,0,2,0,0,14,0ffh
			db  14,32,0,0,14,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
	rook    db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  15,6,0,0,6,6,0,0,6,6,0,0,15,0ffh
			db  15,1,4,0,0,1,0,0,6,1,4,0,0,1,0,0,6,1,4,0,0,1,0,0,15,0ffh
			db  15,1,4,0,0,1,0,0,6,1,4,0,0,1,0,0,6,1,4,0,0,1,0,0,15,0ffh
			db  15,1,4,0,0,8,4,0,0,8,4,0,0,1,0,0,15,0ffh
			db  15,1,4,0,0,8,4,0,0,8,4,0,0,1,0,0,15,0ffh
			db  15,1,28,0,0,1,0,0,15,0ffh
			db  15,1,28,0,0,1,0,0,15,0ffh
			db  15,2,0,26,0,2,0,0,15,0ffh
			db  15,3,0,24,0,3,0,0,15,0ffh
			db  16,3,22,0,0,3,0,0,16,0ffh
			db  17,3,20,0,0,3,0,0,17,0ffh
			db  18,3,0,18,0,3,0,0,18,0ffh
			db  20,2,0,16,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  20,2,0,16,0,2,0,0,20,0ffh
			db  19,3,0,16,0,3,0,0,19,0ffh
			db  18,2,20,0,0,2,0,0,18,0ffh
			db  17,2,22,0,0,2,0,0,17,0ffh
			db  16,2,0,24,0,2,0,0,16,0ffh
			db  15,2,0,26,0,2,0,0,15,0ffh
			db  15,2,0,26,0,2,0,0,15,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  11,6,0,26,0,6,0,0,11,0ffh
			db  11,6,0,26,0,6,0,0,11,0ffh
			db  11,2,34,0,0,2,0,0,11,0ffh
			db  11,2,34,0,0,2,0,0,11,0ffh
			db  11,38,0,0,11,0ffh
		    db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
	knight  db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  16,1,0,0,9,1,0,0,33,0ffh
			db  16,3,0,0,7,2,0,0,32,0ffh
			db  16,4,0,0,5,4,0,0,31,0ffh
			db  16,2,1,0,0,2,0,0,4,2,1,0,0,2,0,0,30,0ffh
			db  16,2,2,0,0,2,0,0,2,2,3,0,0,2,0,0,29,0ffh
			db  16,2,3,0,0,1,0,0,1,3,3,0,0,4,0,0,27,0ffh
			db  16,2,3,0,0,5,3,0,0,7,0,0,24,0ffh
			db  16,3,1,0,0,5,4,0,0,1,4,0,0,4,0,0,22,0ffh
			db  16,3,1,0,0,2,14,0,0,4,0,0,20,0ffh
			db  16,3,19,0,0,3,0,0,19,0ffh
			db  15,2,1,0,0,1,20,0,0,3,0,0,18,0ffh
			db  14,2,24,0,0,3,0,0,17,0ffh
			db  14,2,2,3,0,0,20,0,0,3,0,0,16,0ffh
			db  13,2,2,4,0,0,21,0,0,3,0,0,15,0ffh
			db  13,2,1,4,0,0,23,0,0,3,0,0,14,0ffh
			db  13,2,1,4,0,0,24,0,0,2,0,0,14,0ffh
			db  13,2,1,3,0,0,12,2,0,0,11,0,0,3,0,0,13,0ffh
			db  13,2,1,1,0,0,14,2,0,0,12,0,0,2,0,0,13,0ffh
			db  12,2,17,2,0,0,12,0,0,3,0,0,12,0ffh
			db  11,2,18,2,0,0,13,0,0,2,0,0,12,0ffh
			db  11,2,17,3,0,0,13,0,0,3,0,0,11,0ffh
			db  10,2,18,2,0,0,15,0,0,2,0,0,11,0ffh
			db  10,2,18,0,0,2,15,0,0,3,0,0,10,0ffh
			db  9,2,19,0,0,2,16,0,0,2,0,0,10,0ffh
			db  9,1,19,0,0,3,16,0,0,2,0,0,10,0ffh
			db  8,2,16,0,0,3,0,0,2,1,16,0,0,3,0,0,9,0ffh
			db  8,1,15,0,0,3,0,0,4,1,17,0,0,2,0,0,9,0ffh
			db  7,2,1,2,0,0,10,0,0,3,0,0,5,2,17,0,0,2,0,0,9,0ffh
			db  7,1,2,2,0,0,8,0,0,3,0,0,7,2,17,0,0,3,0,0,8,0ffh
			db  7,1,1,3,0,0,7,0,0,2,0,0,9,2,17,0,0,3,0,0,8,0ffh
			db  7,1,1,2,0,0,7,0,0,2,0,0,9,2,18,0,0,3,0,0,8,0ffh
			db  7,2,4,2,0,0,2,0,0,2,0,0,9,2,20,0,0,2,0,0,8,0ffh
			db  8,2,3,2,0,0,1,0,0,2,0,0,9,3,20,0,0,2,0,0,8,0ffh
			db  8,3,1,2,0,1,1,0,0,1,0,0,10,2,21,0,0,2,0,0,8,0ffh
			db  9,5,1,0,0,2,0,0,9,2,22,0,0,3,0,0,7,0ffh
			db  13,3,0,0,9,2,23,0,0,3,0,0,7,0ffh
			db  24,2,24,0,0,3,0,0,7,0ffh
			db  23,2,25,0,0,3,0,0,7,0ffh
			db  22,2,26,0,0,3,0,0,7,0ffh
			db  22,2,26,0,0,3,0,0,7,0ffh
			db  21,2,27,0,0,3,0,0,7,0ffh
			db  21,1,28,0,0,3,0,0,7,0ffh
			db  20,2,28,0,0,3,0,0,7,0ffh
			db  20,2,28,0,0,3,0,0,7,0ffh
			db  20,2,28,0,0,3,0,0,7,0ffh
			db  20,33,0,0,7,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh			
	bishop	db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  28,4,0,0,28,0ffh
			db  27,2,2,0,0,2,0,0,27,0ffh
			db  27,1,4,0,0,1,0,0,27,0ffh
			db  27,1,4,0,0,1,0,0,27,0ffh
			db  27,2,2,0,0,2,0,0,27,0ffh
			db  28,4,0,0,28,0ffh
			db  28,4,0,0,28,0ffh
			db  27,2,2,0,0,2,0,0,27,0ffh
			db  25,3,4,0,0,3,0,0,25,0ffh
			db  24,3,6,0,0,3,0,0,24,0ffh
			db  23,2,10,0,0,2,0,0,23,0ffh
			db  21,3,12,0,0,3,0,0,21,0ffh
			db  20,3,14,0,0,3,0,0,20,0ffh
			db  19,2,8,2,0,0,8,0,0,2,0,0,19,0ffh
			db  18,2,9,2,0,0,9,0,0,2,0,0,18,0ffh
			db  18,2,9,2,0,0,9,0,0,2,0,0,18,0ffh
			db  18,1,10,2,0,0,10,0,0,1,0,0,18,0ffh
			db  18,1,6,10,0,0,6,0,0,1,0,0,18,0ffh
			db  18,1,6,10,0,0,6,0,0,1,0,0,18,0ffh
			db  18,1,10,2,0,0,10,0,0,1,0,0,18,0ffh
			db  18,1,10,2,0,0,10,0,0,1,0,0,18,0ffh
			db  18,2,9,2,0,0,9,0,0,2,0,0,18,0ffh
			db  18,2,9,2,0,0,9,0,0,2,0,0,18,0ffh
			db  19,2,18,0,0,2,0,0,19,0ffh
			db  19,2,18,0,0,2,0,0,19,0ffh
			db  20,2,16,0,0,2,0,0,20,0ffh
			db  21,2,3,8,0,0,3,0,0,2,0,0,21,0ffh
			db  22,1,0,14,0,1,0,0,22,0ffh
			db  22,1,0,3,0,0,8,3,0,1,0,0,22,0ffh
			db  22,1,14,0,0,1,0,0,22,0ffh
			db  21,2,14,0,0,2,0,0,21,0ffh
			db  21,2,14,0,0,2,0,0,21,0ffh
			db  21,2,0,14,0,2,0,0,21,0ffh
			db  20,2,0,16,0,2,0,0,20,0ffh
			db  20,3,14,0,0,3,0,0,20,0ffh
			db  21,3,12,0,0,3,0,0,21,0ffh
			db  22,16,0,0,22,0ffh
			db  26,8,0,0,26,0ffh
			db  26,2,1,0,0,2,1,0,0,2,0,0,26,0ffh
			db  24,3,2,0,0,2,2,0,0,3,0,0,24,0ffh
			db  8,18,2,0,0,4,2,0,0,18,0,0,8,0ffh
			db  7,17,4,0,0,4,4,0,0,17,0,0,7,0ffh
			db  7,2,18,0,0,2,0,0,2,2,18,0,0,2,0,0,7,0ffh
			db  8,1,16,0,0,3,0,0,4,3,16,0,0,1,0,0,8,0ffh
			db  8,19,0,0,6,19,0,0,8,0ffh
			db  8,3,0,0,38,3,0,0,8,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
    queen	db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  28,4,0,0,28,0ffh
			db  27,6,0,0,27,0ffh
			db  17,4,0,0,6,2,2,0,0,2,0,0,6,4,0,0,17,0ffh
			db  16,6,0,0,5,2,2,0,0,2,0,0,5,6,0,0,16,0ffh
			db  16,2,2,0,0,2,0,0,6,4,0,0,6,2,2,0,0,2,0,0,16,0ffh
			db  16,2,2,0,0,2,0,0,7,2,0,0,7,2,2,0,0,2,0,0,16,0ffh
			db  7,3,0,0,7,4,0,0,8,2,0,0,8,4,0,0,7,3,0,0,7,0ffh
			db  6,5,0,0,8,1,0,0,9,2,0,0,9,1,0,0,8,5,0,0,6,0ffh
			db  6,2,2,0,0,2,0,0,7,1,0,0,9,2,0,0,9,1,0,0,7,2,2,0,0,2,0,0,6,0ffh
			db  6,2,2,0,0,2,0,0,7,1,0,0,9,2,0,0,9,1,0,0,7,2,2,0,0,2,0,0,6,0ffh
			db  6,5,0,0,8,2,0,0,8,2,0,0,8,2,0,0,8,5,0,0,6,0ffh
			db  7,3,0,0,9,2,0,0,8,2,0,0,8,2,0,0,9,3,0,0,7,0ffh
			db  9,1,0,0,9,2,0,0,8,2,0,0,8,2,0,0,9,1,0,0,9,0ffh
			db  10,1,0,0,8,3,0,0,6,4,0,0,6,3,0,0,8,1,0,0,10,0ffh
			db  10,1,0,0,8,3,0,0,6,4,0,0,6,3,0,0,8,1,0,0,10,0ffh
			db  10,2,0,0,7,3,0,0,6,4,0,0,6,3,0,0,7,2,0,0,10,0ffh
			db  11,1,0,0,7,4,0,0,5,4,0,0,5,4,0,0,7,1,0,0,11,0ffh
			db  11,2,0,0,6,1,1,0,0,2,0,0,5,1,2,0,0,1,0,0,5,2,1,0,0,1,0,0,6,2,0,0,11,0ffh
			db  11,2,0,0,6,1,2,0,0,2,0,0,3,2,2,0,0,2,0,0,3,2,2,0,0,1,0,0,6,2,0,0,11,0ffh
			db  11,3,0,0,5,1,2,0,0,2,0,0,3,2,2,0,0,2,0,0,3,2,2,0,0,1,0,0,5,3,0,0,11,0ffh
			db  11,3,0,0,5,1,3,0,0,1,0,0,3,2,2,0,0,2,0,0,3,1,3,0,0,1,0,0,5,3,0,0,11,0ffh
			db  11,4,0,0,4,1,3,0,0,2,0,0,2,2,2,0,0,2,0,0,2,2,3,0,0,1,0,0,4,4,0,0,11,0ffh
			db  12,1,1,0,0,1,0,0,4,1,3,0,0,2,0,0,2,1,4,0,0,1,0,0,2,2,3,0,0,1,0,0,4,1,1,0,0,1,0,0,12,0ffh
			db  12,1,1,0,0,2,0,0,3,1,4,0,0,4,4,0,0,4,4,0,0,1,0,0,3,2,1,0,0,1,0,0,12,0ffh
			db  12,1,2,0,0,2,0,0,2,1,5,0,0,3,4,0,0,3,5,0,0,1,0,0,2,2,2,0,0,1,0,0,12,0ffh
			db  12,1,2,0,0,2,0,0,2,1,5,0,0,10,5,0,0,1,0,0,2,2,2,0,0,1,0,0,12,0ffh
			db  12,1,3,0,0,28,3,0,0,1,0,0,12,0ffh
			db  12,3,1,0,0,13,2,0,0,13,1,0,0,3,0,0,12,0ffh
			db  12,10,16,0,0,10,0,0,12,0ffh
			db  13,7,20,0,0,7,0,0,13,0ffh
			db  13,2,30,0,0,2,0,0,13,0ffh
			db  14,2,3,22,0,0,3,0,0,2,0,0,14,0ffh
			db  15,2,0,26,0,2,0,0,15,0ffh
			db  15,2,0,4,0,0,18,4,0,2,0,0,15,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  15,2,5,16,0,0,5,0,0,2,0,0,15,0ffh
			db  16,2,0,24,0,2,0,0,16,0ffh
			db  16,2,0,6,0,0,12,6,0,2,0,0,16,0ffh
			db  16,2,24,0,0,2,0,0,16,0ffh
			db  16,2,6,12,0,0,6,0,0,2,0,0,16,0ffh
			db  16,2,3,18,0,0,3,0,0,2,0,0,16,0ffh
			db  15,2,0,9,0,0,8,9,0,2,0,0,15,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  14,2,28,0,0,2,0,0,14,0ffh
			db  16,8,12,0,0,8,0,0,16,0ffh
			db  20,20,0,0,20,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
	king	db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  29,2,0,0,29,0ffh
			db  29,2,0,0,29,0ffh
			db  29,2,0,0,29,0ffh
			db  26,8,0,0,26,0ffh
			db  29,2,0,0,29,0ffh
			db  29,2,0,0,29,0ffh
			db  29,2,0,0,29,0ffh
			db  29,2,0,0,29,0ffh
			db  29,2,0,0,29,0ffh
			db  29,2,0,0,29,0ffh
			db  27,6,0,0,27,0ffh
			db  26,1,0,6,0,1,0,0,26,0ffh
			db  25,1,0,1,0,0,6,1,0,1,0,0,25,0ffh
			db  25,1,0,1,0,0,6,1,0,1,0,0,25,0ffh
			db  13,8,0,0,4,1,0,1,0,0,6,1,0,1,0,0,4,8,0,0,13,0ffh
			db  11,2,0,8,0,2,0,0,2,1,0,1,0,0,6,1,0,1,0,0,2,2,0,8,0,2,0,0,11,0ffh
			db  10,1,0,2,0,0,8,2,0,1,0,0,1,1,0,1,0,0,6,1,0,1,0,0,1,1,0,2,0,0,8,2,0,1,0,0,10,0ffh
			db  9,1,0,1,0,0,12,1,0,2,0,1,0,0,6,1,0,2,0,1,0,0,12,1,0,1,0,0,9,0ffh
			db  8,1,0,1,0,0,14,1,0,2,0,1,0,0,4,1,0,2,0,1,0,0,14,1,0,1,0,0,8,0ffh
			db  8,1,0,1,0,0,15,1,0,1,0,1,0,0,4,1,0,1,0,1,0,0,15,1,0,1,0,0,8,0ffh
			db  8,1,0,1,0,0,16,1,0,1,0,1,0,0,2,1,0,1,0,1,0,0,16,1,0,1,0,0,8,0ffh
			db  8,1,0,1,0,0,16,1,0,1,0,1,0,0,2,1,0,1,0,1,0,0,16,1,0,1,0,0,8,0ffh
			db  8,1,0,1,0,0,17,1,0,1,0,2,0,1,0,1,0,0,17,1,0,1,0,0,8,0ffh
			db  8,1,0,1,0,0,18,1,0,2,0,1,0,0,18,1,0,1,0,0,8,0ffh
			db  8,1,0,1,0,0,18,1,0,2,0,1,0,0,18,1,0,1,0,0,8,0ffh
			db  8,1,0,1,0,0,18,1,0,2,0,1,0,0,18,1,0,1,0,0,8,0ffh
			db  9,1,0,1,0,0,17,1,0,2,0,1,0,0,17,1,0,1,0,0,9,0ffh
			db  10,1,0,1,0,0,17,2,0,0,17,1,0,1,0,0,10,0ffh
			db  10,1,0,1,0,0,17,2,0,0,17,1,0,1,0,0,10,0ffh
			db  11,1,0,2,0,0,15,2,0,0,15,2,0,1,0,0,11,0ffh
			db  12,2,0,1,0,0,5,20,0,0,5,1,0,2,0,0,12,0ffh
			db  14,1,0,30,0,1,0,0,14,0ffh
			db  15,2,0,4,0,0,18,4,0,2,0,0,15,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  15,2,26,0,0,2,0,0,15,0ffh
			db  16,2,4,16,0,0,4,0,0,2,0,0,16,0ffh
			db  16,2,0,24,0,2,0,0,16,0ffh
			db  16,2,0,5,0,0,14,5,0,2,0,0,16,0ffh
			db  16,2,24,0,0,2,0,0,16,0ffh
			db  16,2,6,12,0,0,6,0,0,2,0,0,16,0ffh
			db  16,1,1,24,0,0,1,0,0,1,0,0,16,0ffh
			db  15,2,0,8,0,0,10,8,0,2,0,0,15,0ffh
			db  15,4,22,0,0,4,0,0,15,0ffh
			db  14,5,22,0,0,5,0,0,14,0ffh
			db  16,8,12,0,0,8,0,0,16,0ffh
			db  20,20,0,0,20,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh				
	nothing1 db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  60,0ffh  
			
	move    db  60,0ffh
			db  60,0ffh
			db  60,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
			db  3,54,3,0ffh
	        db  60,0ffh
			db  60,0ffh
			db  60,0ffh			
	beginoff db ?
	chessboard   db 0a5h,0a3h,0a2h,0a8h,0a9h,0a2h,0a3h,0a5h
	 length1 = $-chessboard           
	             db 0a1h,0a1h,0a1h,0a1h,0a1h,0a1h,0a1h,0a1h
		     	 db 0h,0h,0h,0h,0h,0h,0h,0h
			     db 0h,0h,0h,0h,0h,0h,0h,0h
			     db 0h,0h,0h,0h,0h,0h,0h,0h
			     db 0h,0h,0h,0h,0h,0h,0h,0h
	 		     db 1h,1h,1h,1h,1h,1h,1h,1h
	             db 5h,3h,2h,8h,9h,2h,3h,5h
	  aEnd1 db ? 
	 co dw ?
	  blackorwhite dw  1
	chessboard2  db 0a5h,0a3h,0a2h,0a8h,0a9h,0a2h,0a3h,0a5h
	                db 0a1h,0a1h,0a1h,0a1h,0a1h,0a1h,0a1h,0a1h
		     	    db 0h,0h,0h,0h,0h,0h,0h,0h
			        db 0h,0h,0h,0h,0h,0h,0h,0h
			        db 0h,0h,0h,0h,0h,0h,0h,0h
			        db 0h,0h,0h,0h,0h,0h,0h,0h
	 		        db 1h,1h,1h,1h,1h,1h,1h,1h
	                db 5h,3h,2h,8h,9h,2h,3h,5h
  	aEnd2 db ?   
	chessboard3     db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh
	                db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh
	                db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh
	                db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh
	                db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh
	                db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh
	                db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh
	                db 0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh,0ffh
  	aEnd3 db ?  


  	whiteorblack dw 0  ;0/1   1 black 0 white 
	  
	chessboardAIMax  db 0a5h,0a3h,0a2h,0a8h,0a9h,0a2h,0a3h,0a5h
	                 db 0a1h,0a1h,0a1h,0a1h,0a1h,0a1h,0a1h,0a1h
		    	     db 0h,0h,0h,0h,0h,0h,0h,0h
			         db 0h,0h,0h,0h,0h,0h,0h,0h
			         db 0h,0h,0h,0h,0h,0h,0h,0h
			         db 0h,0h,0h,0h,0h,0h,0h,0h
	 		         db 1h,1h,1h,1h,1h,1h,1h,1h
	                 db 5h,3h,2h,8h,9h,2h,3h,5h
					 
	chessboardAIMin  db 0a5h,0a3h,0a2h,0a8h,0a9h,0a2h,0a3h,0a5h
	                 db 0a1h,0a1h,0a1h,0a1h,0a1h,0a1h,0a1h,0a1h
		    	     db 0h,0h,0h,0h,0h,0h,0h,0h
			         db 0h,0h,0h,0h,0h,0h,0h,0h
			         db 0h,0h,0h,0h,0h,0h,0h,0h
			         db 0h,0h,0h,0h,0h,0h,0h,0h
	 		         db 1h,1h,1h,1h,1h,1h,1h,1h
	                 db 5h,3h,2h,8h,9h,2h,3h,5h

	movementking dw 0
	movementleftrook dw 0 
	movementrightrook dw 0	 
	castle dw 0  

	movementkingB dw 0
	movementleftrookB dw 0 
	movementrightrookB dw 0	 
	castleB dw 0 

	chessmove dw 1000 dup(0h)
	chessmovepieces dw 1000 dup(0h)
dseg ends	
; -----------------------------------------------------------------------------------------------
;################################################################################################
; -----------------------------------------------------------------------------------------------
sseg segment stack
       dw 1000 dup(?)
sseg ends	  
; -----------------------------------------------------------------------------------------------
;################################################################################################
; -----------------------------------------------------------------------------------------------

cseg segment
assume cs:cseg, ds:dseg,ss:sseg   
; -----------------------------------------------------------------------------------------------
;################################################################################################
; -----------------------------------------------------------------------------------------------
FunctionPawn proc 
	push ax dx bx si 
	add bx,offset chessboard
	cmp bx,offset chessboard
	jnz Pawna         
	loopPawn:
		   mov ah,7
		   int 21h
		   cmp al,'2'
		   jz ePawn
		   cmp al,'3'
		   jz ePawn
		   cmp al,'5'
		   jz ePawn
		   cmp al,'8'
		   jz ePawn
		   jmp loopPawn
		   ePawn:
		   sub al,30h
	       mov ds:[bx][si],al	   
	Pawna:
	       mov dh,4
	       mov dl,ds:[bx-length1][si]
	       cmp dl,0
	       jnz Pawn3 
	       mov ds:[bx-length1][si],dh
		   cmp bx,1095h
		   jnz Pawn3
	       mov dl,ds:[bx-length1-length1][si]
	       cmp dl,0
	       jnz Pawn3
	       mov ds:[bx-length1-length1][si],dh
	Pawn3:
		   inc si 
		   cmp si,length1
		   jnc Pawn1
	       mov dl,[bx-length1][si]
		   cmp dl,10h
		   jc Pawn1
		   mov ds:[bx-length1][si],dh       
	Pawn1:
	       sub si,1 
		   sub si,1
		   jc Pawn2
	       mov dl,[bx-length1][si]
		   cmp dl,10h
		   jc Pawn2
		   mov ds:[bx-length1][si],dh     
	Pawn2:	      
	pop si bx dx ax 
	ret
FunctionPawn endp              
; -----------------------------------------------------------------------------------------------
FunctionKnight proc
	push dx si bx 
	mov dh,4	
	add bx, offset chessboard

	add bx,length1  ;1
	add bx,length1
	inc si 			 
	cmp bx,offset aEnd1
	jnc Knight1a
	cmp si,length1 
	jnc Knight1a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight1
	cmp dl,10h
	jc Knight1a
	Knight1:    
	mov ds:[bx][si],dh
	Knight1a:
	sub bx,length1  ;1
	sub bx,length1
	sub si,1	 
	sub bx,length1  ;2
	sub bx,length1
	inc si 		 
	cmp bx, offset beginoff
	jc Knight2a
	cmp si,length1 
	jnc Knight2a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight2
	cmp dl,10h
	jc Knight2a
	Knight2: 
	mov ds:[bx][si],dh 
	Knight2a:
	add bx,length1  ;2
	add bx,length1
	sub si,1 	 
	add bx,length1;3 
	add bx,length1	 
	sub si,1 
	jc Knight3a
	cmp bx, offset aEnd1
	jnc Knight3a			 
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight3
	cmp dl,10h
	jc Knight3a
	Knight3: 
	mov ds:[bx][si],dh 
	Knight3a:
	sub bx,length1;3 
	sub bx,length1	 
	inc si    		 
	add bx,length1   ;4
	sub si,2 
	jc Knight4a
	cmp bx,offset aEnd1
	jnc Knight4a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight4
	cmp dl,10h
	jc Knight4a
	Knight4: 
	mov ds:[bx][si],dh 
	Knight4a: 
	sub bx,length1   ;4
	add si,2  
	add bx,length1;5
	add si,2 
	cmp si,length1
	jnc Knight5a
	cmp bx,offset aEnd1
	jnc Knight5a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight5
	cmp dl,10h
	jc Knight5a
	Knight5: 
	mov ds:[bx][si],dh 
	Knight5a: 
	sub bx,length1;5
	sub si,2 
	sub bx,length1;6
	sub si,2 
	jc Knight6a
	cmp bx,offset beginoff
	jc Knight6a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight6
	cmp dl,10h
	jc Knight6a
	Knight6: 
	mov ds:[bx][si],dh 
	Knight6a: 
	add bx,length1;6
	add si,2  	 
	sub bx,length1;7
	add si,2 
	cmp si,length1
	jnc Knight7a
	cmp bx,offset beginoff
	jc Knight7a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight7
	cmp dl,10h
	jc Knight7a
	Knight7: 
	mov ds:[bx][si],dh 
	Knight7a: 
	add bx,length1;7
	sub si,2 
	sub bx,length1;8
	sub bx,length1
	inc si 
	cmp si,length1
	jnc Knight8a
	cmp bx,offset beginoff
	jc Knight8a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight8
	cmp dl,10h
	jc Knight8a
	Knight8: 
	mov ds:[bx][si],dh 
	Knight8a: 
	add bx,length1;8
	add bx,length1
	sub si,1 
	sub bx,length1;9
	sub bx,length1
	sub si,1 
	jc Knight9a
	cmp bx,offset beginoff
	jc Knight9a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knight9
	cmp dl,10h
	jc Knight9a
	Knight9: 
	mov ds:[bx][si],dh 
	Knight9a: 
	add bx,length1;9
	add bx,length1
	inc si
	sub bx, offset chessboard
	pop bx si dx 		   
	ret	 
FunctionKnight endp 
; -----------------------------------------------------------------------------------------------
FunctionBishop proc  
	push ax dx bx si  
	mov ax,0
	mov dh,4
	add bx, offset chessboard
	push bx si   
	loopBishop:
			mov ds:[si][bx],dh 
			cmp ax,1
			jz Bishopoption1
			cmp ax,2
			jz Bishopoption2
			cmp ax,3
			jz Bishopoption3
			inc si
			add bx,length1
			cmp si,length1
		    jnc cBishop		
			cmp bx,offset aEnd1
			jnc cBishop
			jmp Bishopbegin1
			Bishopoption1: 
			add bx,length1
			sub si,1
			jc cBishop
			cmp bx,offset aEnd1
			jnc cBishop
			jmp Bishopbegin1
			Bishopoption2:
			inc si
			sub bx,length1
			cmp si,length1
		    jnc cBishop
			cmp bx,offset beginoff
			jc cBishop 
			jmp Bishopbegin1
			Bishopoption3:
	        sub si,1
			jc cBishop
			sub bx,length1
			cmp bx,offset beginoff
			jc cBishop
			Bishopbegin1:
				mov dl,ds:[si][bx]
				cmp dl,0
				jz loopBishop
				cmp dl,10h
				jc cBishop
				mov ds:[si][bx],dh 
	cBishop:		
			pop si bx
			push bx si 
			inc ax
			cmp ax,4
			jz endBishop
			jmp loopBishop
	endBishop :	
		pop si bx 
		mov ah,2
		mov ds:[si][bx],ah
		pop si bx dx ax
		ret	 
FunctionBishop endp 
; -----------------------------------------------------------------------------------------------
FunctionRook proc 
	push ax dx bx si  
	mov ax,0
	mov dh,4
	add bx, offset chessboard
	push bx si 
	looprock:
			mov ds:[si][bx],dh 
			cmp ax,1
			jz rockoption1
			cmp ax,2
			jz rockoption2
			cmp ax,3
			jz rockoption3
			inc si
			cmp si,length1
			jnc crock
			jmp beginrock
			rockoption1:
		    cmp si,0
			jz crock
			sub si,1 
			jmp beginrock
			rockoption2:
			add bx,length1
			cmp bx,offset aEnd1
			jnc crock 
			jmp beginrock
			rockoption3:
			sub bx,length1
			cmp bx,offset beginoff
			jc crock 
			beginrock:
				mov dl,ds:[si][bx]
				cmp dl,0
				jz looprock
				cmp dl,10h
				jc crock
				mov ds:[si][bx],dh 
	crock:		
			pop si bx
			push bx si 
			inc ax
			cmp ax,4
			jz endrock 
			jmp looprock 
	endrock :	
		pop si bx 
		mov dh,5
	    mov ds:[si][bx],dh 
		pop si bx dx ax
		ret	 
FunctionRook endp
; -----------------------------------------------------------------------------------------------
FunctionQueen proc
	call FunctionBishop 
	call FunctionRook
	ret
FunctionQueen endp
; -----------------------------------------------------------------------------------------------
FunctionKing proc 
	push ax dx si bx 
	add bx,offset chessboard
	mov ah,4h

	inc si 
	cmp si,length1
	jnc king1A
	mov al,ds:[bx][si]
	cmp al,0
	jz king1
	cmp al,10h
	jc king1A  
	king1:  
	mov ds:[bx][si],ah
	king1A:
	sub si,1 

	sub si,1  
	jc king2A
	mov al,ds:[bx][si]
	cmp al,0
	jz king2
	cmp al,10h
	jc king2A  
	king2:  
	mov ds:[bx][si],ah
	king2A:
	inc si 

	add bx,length1
	cmp bx,offset aEnd1
	jnc king3A 
	mov al,ds:[bx][si]
	cmp al,0
	jz king3
	cmp al,10h
	jc king3A  
	king3:  
	mov ds:[bx][si],ah
	king3A:
	sub bx,length1
	 
	sub bx,length1 
	cmp bx,offset beginoff 
	jc king4A 

	mov al,ds:[bx][si]
	cmp al,0
	jz king4
	cmp al,10h
	jc king4A  
	king4:  
	mov ds:[bx][si],ah
	king4A:
	add bx,length1 

	add bx,length1
	inc si
	cmp bx,offset aEnd1
	jnc king5A 
	cmp si,length1
	jnc  king5A 

	mov al,ds:[bx][si]
	cmp al,0
	jz king5
	cmp al,10h
	jc king5A  
	king5:  
	mov ds:[bx][si],ah
	king5A:
		sub bx,length1
	sub si,1

	add bx,length1
	sub si,1
	jc king6A 
	cmp bx,offset aEnd1
	jnc king6A 

	mov al,ds:[bx][si]
	cmp al,0
	jz king6
	cmp al,10h
	jc king6A  
	king6:  
	mov ds:[bx][si],ah
	king6A:
	sub bx,length1
	inc si

	sub bx,length1
	inc si 
	cmp bx,offset beginoff
	jc king7A 
	cmp si,length1
	jnc king7A 


	mov al,ds:[bx][si]
	cmp al,0
	jz king7
	cmp al,10h
	jc king7A  
	king7:  
	mov ds:[bx][si],ah
	king7A:
	add bx,length1
	sub si,1 

	sub bx,length1
	sub si,1 
	jc king8A
	cmp bx,offset beginoff
	jc king8A 

	mov al,ds:[bx][si]
	cmp al,0
	jz king8
	cmp al,10h
	jc king8A  
	king8:  
	mov ds:[bx][si],ah
	king8A:
	pop bx si dx ax 
	ret 
FunctionKing endp
; -----------------------------------------------------------------------------------------------
;################################################################################################
; -----------------------------------------------------------------------------------------------
FunctionPawnB proc 
	push ax dx bx si 
	add bx,offset chessboard
	cmp bx,offset chessboard
	jnz PawnBa
	loopPawnB:
	mov ah,7
	int 21h
	cmp al,'2'
	jz ePawnB
	cmp al,'3'
	jz ePawnB
	cmp al,'5'
	jz ePawnB
	cmp al,'8'
	jz ePawnB
	jmp loopPawnB
	ePawnB:
	sub al,30h
	mov ds:[bx][si],al	   
	PawnBa:
	mov dh,4
	mov dl,ds:[bx+length1][si]
	cmp dl,0
	jnz PawnB3 
	mov ds:[bx+length1][si],dh
	cmp bx,106Dh
	jnz PawnB3
	mov dl,ds:[bx+length1+length1][si]
	cmp dl,0
	jnz PawnB3
	mov ds:[bx+length1+length1][si],dh
	PawnB3:
	inc si 
	cmp si,length1
	jnc PawnB1
	mov dl,[bx+length1][si]
	cmp dl,10h
	jnc PawnB1
	cmp dl,0 
	jz PawnB1
	mov ds:[bx+length1][si],dh       
	PawnB1:
	sub si,1 
	sub si,1
	jc PawnB2
	mov dl,[bx+length1][si]
	cmp dl,10h
	jnc PawnB2
	cmp dl,0 
	jz PawnB1
	mov ds:[bx+length1][si],dh     
	PawnB2:	      
	pop si bx dx ax 
	ret
FunctionPawnB endp              
; -----------------------------------------------------------------------------------------------
FunctionknightB proc 
	push dx si bx 
	mov dh,4	
	add bx, offset chessboard

	add bx,length1  ;1
	add bx,length1
	inc si 			 
	cmp bx,offset aEnd1
	jnc knightB1a
	cmp si,length1 
	jnc knightB1a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB1
	cmp dl,10h
	jnc knightB1a
	knightB1:    
	mov ds:[bx][si],dh
	knightB1a:
	sub bx,length1  ;1
	sub bx,length1
	sub si,1	 
	sub bx,length1  ;2
	sub bx,length1
	inc si 		 
	cmp bx, offset beginoff
	jc knightB2a
	cmp si,length1 
	jnc knightB2a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB2
	cmp dl,10h
	jnc knightB2a
	knightB2: 
	mov ds:[bx][si],dh 
	knightB2a:
	add bx,length1  ;2
	add bx,length1
	sub si,1 	 
	add bx,length1;3 
	add bx,length1	 
	sub si,1
	jc knightB3a
	cmp bx, offset aEnd1
	jnc knightB3a			 
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB3
	cmp dl,10h
	jnc knightB3a
	knightB3: 
	mov ds:[bx][si],dh 
	knightB3a:
	sub bx,length1;3 
	sub bx,length1	 
	inc si    		 
	add bx,length1   ;4
	sub si,2 
	jc knightB4a
	cmp bx,offset aEnd1
	jnc knightB4a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB4
	cmp dl,10h
	jnc knightB4a
	knightB4: 
	mov ds:[bx][si],dh 
	knightB4a: 
	sub bx,length1   ;4
	add si,2  
	add bx,length1;5
	add si,2 
	cmp si,length1
	jnc knightB5a
	cmp bx,offset aEnd1
	jnc knightB5a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB5
	cmp dl,10h
	jnc knightB5a
	knightB5: 
	mov ds:[bx][si],dh 
	knightB5a: 
	sub bx,length1;5
	sub si,2 
	sub bx,length1;6
	sub si,2 
	jc knightB6a
	cmp bx,offset beginoff
	jc knightB6a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB6
	cmp dl,10h
	jnc knightB6a
	knightB6: 
	mov ds:[bx][si],dh 
	knightB6a: 
	add bx,length1;6
	add si,2  	 
	sub bx,length1;7
	add si,2 
	cmp si,length1
	jnc knightB7a
	cmp bx,offset beginoff
	jc knightB7a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB7
	cmp dl,10h
	jnc knightB7a
	knightB7: 
	mov ds:[bx][si],dh 
	knightB7a: 
	add bx,length1;7
	sub si,2 
	sub bx,length1;8
	sub bx,length1
	inc si 
	cmp si,length1
	jnc knightB8a
	cmp bx,offset beginoff
	jc knightB8a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB8
	cmp dl,10h
	jnc knightB8a
	knightB8: 
	mov ds:[bx][si],dh 
	knightB8a: 
	add bx,length1;8
	add bx,length1
	sub si,1 
	sub bx,length1;9
	sub bx,length1
	sub si,1 
	jc knightB9a
	cmp bx,offset beginoff
	jc knightB9a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz knightB9
	cmp dl,10h
	jnc knightB9a
	knightB9: 
	mov ds:[bx][si],dh 
	knightB9a: 
	add bx,length1;9
	add bx,length1
	inc si
	sub bx, offset chessboard
	pop bx si dx 		   
	ret	 
FunctionknightB endp 
; -----------------------------------------------------------------------------------------------
FunctionBishopB proc 
	push ax dx bx si  
	mov ax,0
	mov dh,4
	add bx, offset chessboard
	push bx si 
	loopBishopB:
	mov ds:[si][bx],dh 
	cmp ax,1
	jz BishopBoption1
	cmp ax,2
	jz BishopBoption2
	cmp ax,3
	jz BishopBoption3
	inc si
	add bx,length1
	cmp si,length1
	jnc cBishopB		
	cmp bx,offset aEnd1
	jnc cBishopB
	jmp BishopBbegin1
	BishopBoption1: 
	add bx,length1
	sub si,1
	jc cBishopB
	cmp bx,offset aEnd1
	jnc cBishopB
	jmp BishopBbegin1
	BishopBoption2:
	inc si
	sub bx,length1
	cmp si,length1
	jnc cBishopB
	cmp bx,offset beginoff
	jc cBishopB 
	jmp BishopBbegin1
	BishopBoption3:
	sub si,1
	jc cBishopB
	sub bx,length1
	cmp bx,offset beginoff
	jc cBishopB
	BishopBbegin1:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz loopBishopB
	cmp dl,10h
	jnc cBishopB
	mov ds:[si][bx],dh 
	cBishopB:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endBishopB
	jmp loopBishopB
	endBishopB :	
	pop si bx 
	mov ah,0a2h
	mov ds:[bx][si],ah
	pop si bx dx ax
	ret	 
FunctionBishopB endp 
; -----------------------------------------------------------------------------------------------
FunctionRookB proc 
	push ax dx bx si  
	mov ax,0
	mov dh,4
	add bx, offset chessboard
	push bx si 
	loopRockB:
	mov ds:[si][bx],dh 
	cmp ax,1
	jz RockBoption1
	cmp ax,2
	jz RockBoption2
	cmp ax,3
	jz RockBoption3
	inc si
	cmp si,length1
	jnc cRockB
	jmp beginRockB
	RockBoption1:
	cmp si,0
	jz cRockB
	sub si,1 
	jmp beginRockB
	RockBoption2:
	add bx,length1
	cmp bx,offset aEnd1
	jnc cRockB 
	jmp beginRockB
	RockBoption3:
	sub bx,length1
	cmp bx,offset beginoff
	jc cRockB 
	beginRockB:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz loopRockB
	cmp dl,10h
	jnc cRockB
	mov ds:[si][bx],dh 
	cRockB:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endRockB 
	jmp loopRockB 
	endRockB :	
	pop si bx 
	mov dh,0a5h
	mov ds:[si][bx],dh 
	pop si bx dx ax
	ret	 
FunctionRookB endp
; -----------------------------------------------------------------------------------------------
FunctionQueenB proc
	call FunctionBishopB 
	call FunctionRookB
	ret
FunctionQueenB endp
; -----------------------------------------------------------------------------------------------
FunctionKingB proc 
	push ax dx si bx 
	add bx,offset chessboard
	mov ah,4h

	inc si 
	cmp si,length1
	jnc KingB1A
	mov al,ds:[bx][si]
	cmp al,0
	jz KingB1
	cmp al,10h
	jnc KingB1A  
	KingB1:  
	mov ds:[bx][si],ah
	KingB1A:
	sub si,1 

	sub si,1  
	jc KingB2A
	mov al,ds:[bx][si]
	cmp al,0
	jz KingB2
	cmp al,10h
	jnc KingB2A  
	KingB2:  
	mov ds:[bx][si],ah
	KingB2A:
	inc si 

	add bx,length1
	cmp bx,offset aEnd1
	jnc KingB3A 
	mov al,ds:[bx][si]
	cmp al,0
	jz KingB3
	cmp al,10h
	jnc KingB3A  
	KingB3:  
	mov ds:[bx][si],ah
	KingB3A:
	sub bx,length1

	sub bx,length1 
	cmp bx,offset beginoff 
	jc KingB4A 

	mov al,ds:[bx][si]
	cmp al,0
	jz KingB4
	cmp al,10h
	jnc KingB4A  
	KingB4:  
	mov ds:[bx][si],ah
	KingB4A:
	add bx,length1 

	add bx,length1
	inc si
	cmp bx,offset aEnd1
	jnc KingB5A 
	cmp si,length1
	jnc  KingB5A 

	mov al,ds:[bx][si]
	cmp al,0
	jz KingB5
	cmp al,10h
	jnc KingB5A  
	KingB5:  
	mov ds:[bx][si],ah
	KingB5A:
	sub bx,length1
	sub si,1

	add bx,length1
	sub si,1
	jc KingB6A 
	cmp bx,offset aEnd1
	jnc KingB6A 

	mov al,ds:[bx][si]
	cmp al,0
	jz KingB6
	cmp al,10h
	jnc KingB6A  
	KingB6:  
	mov ds:[bx][si],ah
	KingB6A:
	sub bx,length1
	inc si

	sub bx,length1
	inc si 
	cmp bx,offset beginoff
	jc KingB7A 
	cmp si,length1
	jnc KingB7A 


	mov al,ds:[bx][si]
	cmp al,0
	jz KingB7
	cmp al,10h
	jnc KingB7A  
	KingB7:  
	mov ds:[bx][si],ah
	KingB7A:
	add bx,length1
	sub si,1 

	sub bx,length1
	sub si,1 
	jc KingB8A
	cmp bx,offset beginoff
	jc KingB8A 

	mov al,ds:[bx][si]
	cmp al,0
	jz KingB8
	cmp al,10h
	jnc KingB8A  
	KingB8:  
	mov ds:[bx][si],ah
	KingB8A:
	pop bx si dx ax 
	ret 
FunctionKingB endp
; -----------------------------------------------------------------------------------------------
;################################################################################################
; -----------------------------------------------------------------------------------------------
checkW  proc
	push bp 
	mov bp,sp
	push bx si dx 			 

	push co co  
	call Kingposition 
	pop si bx

	add bx,length1  ;1
	add bx,length1
	inc si 			 
	cmp bx,offset aEnd1
	jnc Knight1acheckW
	cmp si,length1 
	jnc Knight1acheckW
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck1 
	jmp endcheck 
	endcheck1:
	Knight1acheckW:
	sub bx,length1  ;1
	sub bx,length1
	sub si,1	 
	sub bx,length1  ;2
	sub bx,length1
	inc si 		 
	cmp bx,offset beginoff
	jc Knight2acheckW
	cmp si,length1 
	jnc Knight2acheckW
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck2
	jmp endcheck 
	endcheck2:
	Knight2acheckW:
	add bx,length1  ;2
	add bx,length1
	sub si,1 	 
	add bx,length1;3 
	add bx,length1	 
	sub si,1
	jc Knight3acheckW
	cmp bx, offset aEnd1
	jnc Knight3acheckW			 
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck3 
	jmp endcheck 
	endcheck3:
	Knight3acheckW:
	sub bx,length1;3 
	sub bx,length1	 
	inc si    		 
	add bx,length1   ;4
	sub si,2 
	jc Knight4acheckW
	cmp bx,offset aEnd1
	jnc Knight4acheckW
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck4 
	jmp endcheck 
	endcheck4: 
	Knight4acheckW: 
	sub bx,length1   ;4
	add si,2  
	add bx,length1;5
	add si,2 
	cmp si,length1
	jnc Knight5acheckW
	cmp bx,offset aEnd1
	jnc Knight5acheckW
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck5 
	jmp endcheck 
	endcheck5:
	Knight5acheckW: 
	sub bx,length1;5
	sub si,2 
	sub bx,length1;6
	sub si,2 
	jc Knight6acheckW
	cmp bx,offset beginoff
	jc Knight6acheckW
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck6 
	jmp endcheck 
	endcheck6:
	Knight6acheckW: 
	add bx,length1;6
	add si,2  	 
	sub bx,length1;7
	add si,2 
	cmp si,length1
	jnc Knight7acheckW
	cmp bx,offset beginoff
	jc Knight7acheckW
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck7
	jmp endcheck 
	endcheck7:
	Knight7acheckW: 
	add bx,length1;7
	sub si,2 
	sub bx,length1;8
	sub bx,length1
	inc si 
	cmp si,length1
	jnc Knight8acheckW
	cmp bx,offset beginoff
	jc Knight8acheckW
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck8 
	jmp endcheck 
	endcheck8:
	Knight8acheckW: 
	add bx,length1;8
	add bx,length1
	sub si,1 
	sub bx,length1;9
	sub bx,length1
	sub si,1
	jc Knight9acheckW
	cmp bx,offset beginoff
	jc Knight9acheckW
	mov dl,ds:[bx][si]
	cmp dl,0a3h
	jnz endcheck9 
	jmp endcheck 
	endcheck9:
	Knight9acheckW: 
	add bx,length1;9
	add bx,length1
	inc si	
	push ax dx bx si 	
	mov ax,0			 
	looprockcheckW:
	cmp ax,1
	jz rockoption1checkW
	cmp ax,2
	jz rockoption2checkW
	cmp ax,3
	jz rockoption3checkW
	inc si
	cmp si,length1
	jnc crockcheckW
	jmp rockbegin1checkW
	rockoption1checkW:
	cmp si,0
	jz crockcheckW
	sub si,1 
	jmp rockbegin1checkW
	rockoption2checkW:
	add bx,length1
	cmp bx,offset aEnd1
	jnc crockcheckW 
	jmp rockbegin1checkW
	rockoption3checkW:
	sub bx,length1
	cmp bx,offset beginoff
	jc crockcheckW 
	rockbegin1checkW:
	mov dl,ds:[bx][si]
	cmp dl,0a5h
	jnz endcheck10
	jmp endchecka
	endcheck10:
	cmp dl,0a8h
	jnz endcheck11
	jmp endchecka         		  
	endcheck11:
	cmp dl,4h
	jz looprockcheckW
	cmp dl,0h   
	jnz crockcheckW			
	jmp looprockcheckW
	crockcheckW:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endrockcheckW 
	jmp looprockcheckW
	endrockcheckW :	
	pop si bx dx ax
	push ax dx bx si 	    		  
	mov ax,0
	loopBishopcheckW:
	cmp ax,1
	jz Bishopoption1checkW
	cmp ax,2
	jz Bishopoption2checkW
	cmp ax,3
	jz Bishopoption3checkW
	inc si
	add bx,length1
	cmp si,length1
	jnc cBishopcheckW	
	cmp bx,offset aEnd1
	jnc cBishopcheckW
	jmp Bishopbegin1checkW
	Bishopoption1checkW:
	sub si,1 
	jc cBishopcheckW
	add bx,length1
	cmp bx,offset aEnd1
	jnc cBishopcheckW
	jmp Bishopbegin1checkW
	Bishopoption2checkW:
	inc si
	sub bx,length1
	cmp si,length1
	jnc cBishopcheckW
	cmp bx,offset beginoff
	jc cBishopcheckW
	jmp Bishopbegin1checkW
	Bishopoption3checkW:
	sub si,1 
	jc cBishopcheckW
	sub bx,length1
	cmp si,length1
	jnc cBishopcheckW
	cmp bx,offset beginoff
	jc cBishopcheckW
	Bishopbegin1checkW:
	mov dl,ds:[si][bx]
	cmp dl,0a2h
	jnz endcheck12
	jmp endchecka
	endcheck12:
	cmp dl,0a8h
	jnz endcheck13
	jmp endchecka 
	endcheck13:		
	cmp dl,4h
	jz loopBishopcheckW	 
	cmp dl,0h
	jnz cBishopcheckW		
	jmp loopBishopcheckW
	cBishopcheckW:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endBishopcheckW
	jmp loopBishopcheckW
	endBishopcheckW :	
	pop si bx dx ax
	sub bx,length1
	inc si
	mov dl,ds:[bx][si]
	cmp dl,0a1h
	jnz endcheck14
	jmp endcheck
	endcheck14:
	add bx,length1
	sub si,1
	sub bx,length1
	sub si,1
	mov dl,ds:[bx][si]
	cmp dl,0a1h
	jnz endcheck15
	jmp endcheck
	endcheck15:
	add bx,length1
	inc si

	inc si      ;1
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jnz endcheck16
	jmp endcheck
	endcheck16:
	sub si,1 
	sub si,1     ;2
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jnz endcheck17
	jmp endcheck
	endcheck17:
	inc si 
	sub bx,length1 ;3
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jnz endcheck18
	jmp endcheck
	endcheck18:
	add bx,length1 
	add bx,length1 ;4
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jnz endcheck19
	jmp endcheck
	endcheck19:
	sub bx,length1
	add bx,length1 ;5
	inc si         
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jnz endcheck20
	jmp endcheck
	endcheck20:
	sub bx,length1
	sub si,1
	add bx,length1 ;6
	sub si,1         
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jnz endcheck21
	jmp endcheck
	endcheck21:
	sub bx,length1
	inc si
	sub bx,length1 ;7
	sub si,1         
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jnz endcheck22
	jmp endcheck
	endcheck22:
	add bx,length1
	inc si
	sub bx,length1 ;7
	inc si         
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jnz endcheck23
	jmp endcheck
	endcheck23:
	add bx,length1
	sub si,1	

	mov dx,0h
	mov ss:[bp+4],dx
	jmp echeck 
	endcheck:
	mov dx,1h
	mov ss:[bp+4],dx	    
	jmp echeck
	endchecka:		
	pop si bx dx ax  
	mov dx,1h
	mov ss:[bp+4],dx	
	echeck :  
	pop dx si bx 
	pop bp 
	ret 
checkW endp
; -----------------------------------------------------------------------------------------------
checkB  proc
	push bp 
	mov bp,sp
	push bx si dx 			 

	push co co   
	call KingpositionB 
	pop si bx

	add bx,length1  ;1
	add bx,length1
	inc si 			 
	cmp bx,offset aEnd1
	jnc Knight1acheckB
	cmp si,length1 
	jnc Knight1acheckB
	mov dl,ds:[bx][si]
	cmp dl,03h
	jnz endcheckB1 
	jmp endcheckB 
	endcheckB1:
	Knight1acheckB:
		 sub bx,length1  ;1
	     sub bx,length1
		 sub si,1	 
		 sub bx,length1  ;2
	     sub bx,length1
		 inc si 		 
		 cmp bx,offset beginoff
		 jc Knight2acheckB
		 cmp si,length1 
		 jnc Knight2acheckB
		 mov dl,ds:[bx][si]
		 cmp dl,03h
		 jnz endcheckB2
		 jmp endcheckB 
		 endcheckB2:
	Knight2acheckB:
	     add bx,length1  ;2
	     add bx,length1
		 sub si,1 	 
		 add bx,length1;3 
	     add bx,length1	 
		 sub si,1
		 jc Knight3acheckB
	     cmp bx,offset aEnd1
		 jnc Knight3acheckB			 
		 mov dl,ds:[bx][si]
		 cmp dl,03h
		 jnz endcheckB3 
		 jmp endcheckB 
		 endcheckB3:
	Knight3acheckB:
		 sub bx,length1;3 
	     sub bx,length1	 
		 inc si    		 
	     add bx,length1   ;4
		 sub si,2 
		 jc Knight4acheckB
		 cmp bx,offset aEnd1
		 jnc Knight4acheckB
	     mov dl,ds:[bx][si]
		 cmp dl,03h
		 jnz endcheckB4 
		 jmp endcheckB 
		 endcheckB4: 
	Knight4acheckB: 
		 sub bx,length1   ;4
		 add si,2  
		 add bx,length1;5
		 add si,2 
		 cmp si,length1
		 jnc Knight5acheckB
		 cmp bx,offset aEnd1
		 jnc Knight5acheckB
		 mov dl,ds:[bx][si]
		 cmp dl,03h
		 jnz endcheckB5 
		 jmp endcheckB 
		 endcheckB5:
	Knight5acheckB: 
		 sub bx,length1;5
		 sub si,2 
		 sub bx,length1;6
		 sub si,2 
	     jc Knight6acheckB
		 cmp bx,offset beginoff
		 jc Knight6acheckB
		 mov dl,ds:[bx][si]
		 cmp dl,03h
		 jnz endcheckB6 
		 jmp endcheckB 
		 endcheckB6:
	Knight6acheckB: 
	     add bx,length1;6
		 add si,2  	 
		 sub bx,length1;7
		 add si,2 
		 cmp si,length1
		 jnc Knight7acheckB
		 cmp bx,offset beginoff
		 jc Knight7acheckB
		 mov dl,ds:[bx][si]
		 cmp dl,03h
		 jnz endcheckB7
		 jmp endcheckB 
		 endcheckB7:
	Knight7acheckB: 
	     add bx,length1;7
		 sub si,2 
		 sub bx,length1;8
	     sub bx,length1
		 inc si 
		 cmp si,length1
		 jnc Knight8acheckB
		 cmp bx,offset beginoff
		 jc Knight8acheckB
		 mov dl,ds:[bx][si]
		 cmp dl,03h
		 jnz endcheckB8 
		 jmp endcheckB 
		 endcheckB8:
	Knight8acheckB: 
	     add bx,length1;8
	     add bx,length1
		 sub si,1 
		 sub bx,length1;9
	     sub bx,length1
		 sub si,1
		 jc Knight9acheckB
		 cmp bx,offset beginoff
		 jc Knight9acheckB
		 mov dl,ds:[bx][si]
		 cmp dl,03h
		 jnz endcheckB9 
		 jmp endcheckB 
		 endcheckB9:
	Knight9acheckB: 
	     add bx,length1;9
	     add bx,length1
	     inc si	
	     push ax dx bx si 	
	     mov ax,0			 
	looprockcheckB:
	cmp ax,1
	jz rockoption1checkB
	cmp ax,2
	jz rockoption2checkB
	cmp ax,3
	jz rockoption3checkB
	inc si
	cmp si,length1
	jnc crockcheckB
	jmp rockbegin1checkB
	rockoption1checkB:
	cmp si,0
	jz crockcheckB
	sub si,1 
	jmp rockbegin1checkB
	rockoption2checkB:
	add bx,length1
	cmp bx,offset aEnd1
	jnc crockcheckB 
	jmp rockbegin1checkB
	rockoption3checkB:
	sub bx,length1
	cmp bx,offset beginoff
	jc crockcheckB 
	rockbegin1checkB:
		 mov dl,ds:[bx][si]
		 cmp dl,05h
		 jnz endcheckB10
		 jmp endcheckBa
		 endcheckB10:
		 cmp dl,08h
		 jnz endcheckB11
		 jmp endcheckBa         		  
		 endcheckB11:
		 cmp dl,4h
		 jz looprockcheckB
		 cmp dl,0h   
	     jnz crockcheckB			
		 jmp looprockcheckB
	crockcheckB:		
		pop si bx
		push bx si 
	inc ax
	cmp ax,4
	jz endrockcheckB 
	jmp looprockcheckB
	endrockcheckB :	
	  pop si bx dx ax
	  push ax dx bx si 	    		  
	  mov ax,0
	loopBishopcheckB:
	cmp ax,1
	jz Bishopoption1checkB
	cmp ax,2
	jz Bishopoption2checkB
	cmp ax,3
	jz Bishopoption3checkB
	inc si
	add bx,length1
	cmp si,length1
	jnc cBishopcheckB	
	cmp bx,offset aEnd1
	jnc cBishopcheckB
	jmp Bishopbegin1checkB
	Bishopoption1checkB:
	sub si,1 
	jc cBishopcheckB
	add bx,length1
	cmp bx,offset aEnd1
	jnc cBishopcheckB
	jmp Bishopbegin1checkB
	Bishopoption2checkB:
	inc si
	sub bx,length1
	cmp si,length1
	jnc cBishopcheckB
	cmp bx,offset beginoff
	jc cBishopcheckB
	jmp Bishopbegin1checkB
	Bishopoption3checkB:
	sub si,1 
	jc cBishopcheckB
	sub bx,length1
	cmp si,length1
	jnc cBishopcheckB
	cmp bx,offset beginoff
	jc cBishopcheckB
	Bishopbegin1checkB:
		mov dl,ds:[si][bx]
	     cmp dl,02h
		 jnz endcheckB12
		 jmp endcheckBa
		 endcheckB12:
		 cmp dl,08h
		 jnz endcheckB13
		 jmp endcheckBa 
		 endcheckB13:		
	     cmp dl,4h
		 jz loopBishopcheckB	 
		 cmp dl,0h
	     jnz cBishopcheckB		
		 jmp loopBishopcheckB
	cBishopcheckB:		
		pop si bx
		push bx si 
	inc ax
	cmp ax,4
	jz endBishopcheckB
	jmp loopBishopcheckB
	endBishopcheckB :	
	pop si bx dx ax
	add bx,length1
	inc si
	mov dl,ds:[bx][si]
	cmp dl,01h
	jnz endcheckB14
	jmp endcheckB
	endcheckB14:
	sub bx,length1
	sub si,1
	add bx,length1
	sub si,1
	mov dl,ds:[bx][si]
	cmp dl,01h
	jnz endcheckB15
	jmp endcheckB
	endcheckB15:
	sub bx,length1
	inc si

	inc si      ;1
	mov dl,ds:[bx][si]
	cmp dl,09h
	jnz endcheckB16
	jmp endcheckB
	endcheckB16:
	sub si,1 
	sub si,1     ;2
	mov dl,ds:[bx][si]
	cmp dl,09h
	jnz endcheckB17
	jmp endcheckB
	endcheckB17:
	inc si 
	sub bx,length1 ;3
	mov dl,ds:[bx][si]
	cmp dl,09h
	jnz endcheckB18
	jmp endcheckB
	endcheckB18:
	add bx,length1 
	add bx,length1 ;4
	mov dl,ds:[bx][si]
	cmp dl,09h
	jnz endcheckB19
	jmp endcheckB
	endcheckB19:
	sub bx,length1
	add bx,length1 ;5
	inc si         
	mov dl,ds:[bx][si]
	cmp dl,09h
	jnz endcheckB20
	jmp endcheckB
	endcheckB20:
	sub bx,length1
	sub si,1
	add bx,length1 ;6
	sub si,1         
	mov dl,ds:[bx][si]
	cmp dl,09h
	jnz endcheckB21
	jmp endcheckB
	endcheckB21:
	sub bx,length1
	inc si
	sub bx,length1 ;7
	sub si,1         
	mov dl,ds:[bx][si]
	cmp dl,09h
	jnz endcheckB22
	jmp endcheckB
	endcheckB22:
	add bx,length1
	inc si
	sub bx,length1 ;7
	inc si         
	mov dl,ds:[bx][si]
	cmp dl,09h
	jnz endcheckB23
	jmp endcheckB
	endcheckB23:
	add bx,length1
	sub si,1	

	mov dx,0h
	mov ss:[bp+4],dx
	jmp echeckB 
	endcheckB:
	mov dx,1h
	mov ss:[bp+4],dx	    
	jmp echeckB
	endcheckBa:		
	pop si bx dx ax  
	mov dx,1h
	mov ss:[bp+4],dx	
	echeckB :  
	pop dx si bx 
	pop bp 
	ret 
checkB endp
; -----------------------------------------------------------------------------------------------
Kingposition proc      
	push bp  
	mov bp,sp
	push dx di 
	mov bx,offset chessboard			 
	mov si,0
	loopKingposition:
	mov dl,ds:[bx][si]
	cmp dl,09h
	jz endKingposition
	inc si
	cmp si,length1
	jc loopKingposition
	mov si,0
	add bx,length1
	cmp bx,offset aEnd1
	jc loopKingposition 
	endKingposition:
	pop di dx 
	mov ss:[bp+4],si 
	mov ss:[bp+6],bx
	pop bp  
	ret 
Kingposition endp
; -----------------------------------------------------------------------------------------------
KingpositionB proc      
	push bp  
	mov bp,sp
	push dx di 
	mov bx,offset chessboard			 
	mov si,0
	loopKingpositionB:
	mov dl,ds:[bx][si]
	cmp dl,0a9h
	jz endKingpositionB
	inc si
	cmp si,length1
	jc loopKingpositionB
	mov si,0
	add bx,length1
	cmp bx,offset aEnd1
	jc loopKingpositionB 
	endKingpositionB:
	pop di dx 
	mov ss:[bp+4],si 
	mov ss:[bp+6],bx
	pop bp  
	ret 
KingpositionB endp
; -----------------------------------------------------------------------------------------------
functionDraw proc  

	push ax bx cx dx si bp di   ; push all vars

	mov cx,0
	mov dx,0      

	mov ah,0Ch

	;int 10h       ; Write graphics pixel,  CX = x, DX = y , AL = Color
	; Read graphics pixel    AH=0Dh BH = Page Number,CX = x, DX = y return al = color  

	jmp beforeDraw	   
	BeforeDraw2:
	pop si 
	pop bp di  
	push co co
	jmp enddraw
	BeforeDraw:


	push bp di ; bp = x  , di = y  ;  push cord 
	add bp,di  ; x+y 
	ror bp,1   ; (x+y)/2   cf 1 -->white | 0 ->green 
	jc blackorwhite1  
	mov di,offset blackorwhite
	mov bp,2 
	mov ds:[di],bp
	jmp blackorwhite2 		 
	blackorwhite1:
	mov di,offset blackorwhite
	mov bp,0fh 
	mov ds:[di],bp
	blackorwhite2:
	pop di bp  ; x y 
	push 60 di  
	call multifun
	pop di co   ; x*60
	push di   
	push 60 bp  
	call multifun
	pop bp co ;y*60
	dec bp 
	push bp   ; 60x 60y  -> stack
	mov cx,di 
	mov dx,bp
	sub dx,60

	Draw1: 
	mov bp,ds:[si]
	and bp,0ffh  
	cmp si,offset aEnd1
	jc functionDrawC
	jmp enddraw 
	functionDrawC:
	inc si
	push si 
	cmp bp,0a5h
	jz DrawBlackRock
	cmp bp,0a3h
	jz DrawBlackKnight
	cmp bp,0a2h
	jz DrawBlackBishop
	cmp bp,0a8h
	jz DrawBlackQueen
	cmp bp,0a9h
	jz DrawBlackKing
	cmp bp,0a1h
	jz DrawBlackPawn
	cmp bp,5h
	jz DrawRock
	cmp bp,3h
	jz DrawKnight
	cmp bp,2h
	jz DrawBishop
	cmp bp,8h
	jz DrawQueen 
	cmp bp,9h
	jz DrawKing
	cmp bp,1h
	jz DrawPawn  
	cmp bp,0h	   
	jz DrawNothing
	jmp Draw1
	DrawBlackRock:
	mov si,offset rook
	jmp DrawBlackA1
	DrawBlackKnight:
	mov si,offset knight
	jmp DrawBlackA1
	DrawBlackBishop:
	mov si,offset bishop
	jmp DrawBlackA1
	DrawBlackQueen:
	mov si,offset queen
	jmp DrawBlackA1
	DrawBlackKing:
	mov si,offset king
	jmp DrawBlackA1
	DrawBlackPawn:	   
	mov si,offset pawn
	jmp DrawBlackA1
	DrawRock:
	mov si,offset rook
	jmp DrawWhiteA1
	DrawKnight:
	mov si,offset knight
	jmp DrawWhiteA1
	DrawBishop:
	mov si,offset bishop 
	jmp DrawWhiteA1
	DrawQueen:
	mov si,offset queen
	jmp DrawWhiteA1
	DrawKing:
	mov si,offset king
	jmp DrawWhiteA1
	DrawPawn:	   
	mov si,offset pawn
	jmp DrawWhiteA1	  
	DrawNothing:
	mov si,offset nothing1 
	jmp DrawWhiteA1	  
	DrawWhiteA:
	mov bh,0
	inc si         ; color number 
	DrawWhiteA1:
	mov di,ds:[si] ; number of pixels
	and di,0ffh
	cmp di,0ffh
	jz DrawWhiteEnd
	push si 
	mov si,offset blackorwhite
	mov al,ds:[si]
	pop si	
	DrawWhite:   
	sub di,1   ;  while (di-- > 0) 
	jc Cwhite	
    int 10h
 	inc cx		
	jmp DrawWhite	
	Cwhite:
	inc si
	mov di,ds:[si]
	and di,0ffh
	cmp di,0ffh
	jz DrawWhiteEnd
	mov al,0
	DrawWhite1:   
	sub di,1  
	jc 	Cwhite1		
	int 10h
	inc cx				
	jmp DrawWhite1	
	Cwhite1:
	inc si
	mov di,ds:[si]
	and di,0ffh
	cmp di,0ffh
	jz DrawWhiteEnd
	mov al,0fh
	DrawWhite2:   
	sub di,1  
	jc Cwhite2		
	int 10h
	inc cx			
	jmp DrawWhite2	
	Cwhite2:
	inc si
	mov di,ds:[si]
	and di,0ffh
	cmp di,0ffh
	jz DrawWhiteEnd
	mov al,0h
	DrawWhite3:   
	sub di,1  
	jc Cwhite3	
	int 10h
	inc cx				
	jmp DrawWhite3	
	Cwhite3:
	jmp DrawWhiteA
	DrawWhiteEnd:
	inc dx
	pop co bp di  
	push di bp co
	mov cx,di
	cmp dx,bp
	jc  functionDrawC1
	jmp  BeforeDraw2 
	functionDrawC1:
	jmp DrawWhiteA
	DrawBlackA:
	mov bh,0
	inc si
	DrawBlackA1:
	mov di,ds:[si]    ;di=0 s 
	and di,0ffh
	cmp di,0ffh
	jz DrawBlackEnd
	push si 
	mov si,offset blackorwhite
	mov al,ds:[si]
	pop si		
	DrawBlack:   
	sub di,1  
	jc CBlack	
	int 10h	
	inc cx		
	jmp DrawBlack	
	CBlack:
	inc si
	mov di,ds:[si]
	and di,0ffh
	cmp di,0ffh
	jz DrawBlackEnd
	mov al,8
	DrawBlack1:   
	sub di,1  
	jc 	CBlack1	
    int 10h	
	inc cx				
	jmp DrawBlack1	
	CBlack1:
	inc si
	mov di,ds:[si]
	and di,0ffh
	cmp di,0ffh
	jz DrawBlackEnd
	mov al,0
	DrawBlack2:   
	sub di,1  
	jc CBlack2		
	int 10h	
	inc cx			
	jmp DrawBlack2	
	CBlack2:
	inc si
	mov di,ds:[si]
	and di,0ffh
	cmp di,0ffh
	jz DrawBlackEnd
	mov al,7h
	DrawBlack3:   
	sub di,1  
	jc CBlack3	
	int 10h	
	inc cx				
	jmp DrawBlack3	
	CBlack3:
	jmp DrawBlackA
	DrawBlackEnd:
	inc dx
	pop co bp di  
	push di bp co
	mov cx,di
	cmp dx,bp
	jc  functionDrawC2
	jmp  BeforeDraw2 
	functionDrawC2:
	jmp DrawBlackA		  
	enddraw :
	pop co co
	pop di bp si dx cx bx ax 
	ret
functionDraw endp    
; -----------------------------------------------------------------------------------------------
updateBoard proc   
	push si bx ax cx dx di bp
	mov si,offset chessboard
	mov bx,offset chessboard3
	loopupdate:
	mov dl,ds:[si]
	mov dh,ds:[bx] 
	cmp dl,dh 
	je co_update
    

  
    xor bp,bp ; bp = 0
    mov di,si  
	sub di,offset chessboard

	updateBoard1:
	inc bp 
	sub di,8
	jnc updateBoard1
	add di,8
    call functionDraw

    co_update:
	mov ds:[bx],dl
	inc bx 
	inc si
	cmp si,offset aEnd1

	jne loopupdate
	pop bp di dx cx ax bx si 
	ret 
updateBoard endp    
;-----------------------------------------------------------------------------------------------
multifun proc
	push bp
	mov bp,sp
	push ax bx cx 
	mov ax,ss:[bp+6]
	mov bx,ss:[bp+4]
	mov cx,0
	multi:
	shr ax,1 
	jnc multi1
	add cx, bx
	jmp multi2
	multi1:
	shl bx,1
	jmp multi 
	multi2:
	cmp ax,0
	jnz multi1
	mov ax,0
	mov ss:[bp+4],cx
	mov ss:[bp+6],ax
	pop cx bx ax 
	pop bp 	
	ret 
multifun endp
; -----------------------------------------------------------------------------------------------
movefunction proc
	push ax bx cx dx bp si di 
	mov si,offset chessboard2
	mov di,0
	push di 
	jmp returnmove
	returnmove1: 
	pop si bp di  
	returnmove:
	
	mov ah,7
	int 21h          ; 	Direct char read (STDIN), no echo
	cmp al,' '
	jnz notmove1
	jmp move1
	notmove1:
	cmp al,'a'
	jz pressedA
	cmp al,'d'
	jz pressedD
	cmp al,'w'
	jz pressedW
	cmp al,'s'
	jz pressedS
	jmp returnmove
	pressedA:
	sub si,1
	jmp delete
	inc si 		  
	jmp returnmove
	pressedD:  
	inc si
	jmp delete
	pressedS:
	add si ,8
	cmp si,offset aEnd2
	jc delete
	sub si,8
	jmp returnmove	
	pressedW:
	sub si,8
	cmp si,offset beginoff
	jnc delete
	add si,8
	jmp returnmove
	delete: 	 
	mov cx,di
	mov dx,bp
	add cx,dx 
	mov dx,0
	divdelete:
	inc dx
	sub cx,60
	jnc divdelete
	ror dx,1 
	jnc delete2 	 
	delete1:		
	mov al,2h	
	jmp delete2a	   
	delete2:		
	mov al,0fh
	delete2a:		 
	mov ah,0Ch 
	mov cx,di 
	mov dx,bp
	sub dx,60		
	push di bp
	push si		 
	mov si,offset move   
	jmp Drawmove1A
	DrawmoveA1:
	inc si
	Drawmove1A:
	mov di,ds:[si]    
	and di,0ffh
	cmp di,0ffh
	jz DrawmoveEnd1	
	Drawmove11:   
	sub di,1  
	jc Cmove11	
	int 10h			
	inc cx		
	jmp Drawmove11	
	Cmove11:
	inc si
	mov di,ds:[si]
	and di,0ffh
	cmp di,0ffh
	jz DrawmoveEnd1
	Drawmove21:   
	add cx,di
	jmp DrawmoveA1		
	DrawmoveEnd1:
	inc dx
	pop co bp di 
	push di bp co 
	mov cx,di
	cmp dx,bp
	jc notreturnmove1
	jmp printmove1
	notreturnmove1:
	jmp DrawmoveA1	
	printmove1: 
	pop si bp di 
	printmove:
	mov di,si 
	sub di,offset chessboard2
	mov bp,0 
	BeforeDraw1move:
	inc bp 
	sub di,8
	jnc BeforeDraw1move
	add di,8	 
	push 60 di
	call multifun
	pop di co
	push di 
	push 60 bp
	call multifun
	pop bp co
	push bp   
	mov cx,di 
	mov dx,bp
	sub dx,60	
	mov al,0 	 
	push si		 
	mov si,offset move   
	mov ah,0Ch
	mov bh,0                        
	jmp  Drawmove                               
	DrawmoveA:
	inc si
	Drawmove:
	mov di,ds:[si]    
	and di,0ffh
	cmp di,0ffh
	jz DrawmoveEnd	
	Drawmove1:   
	sub di,1  
	jc Cmove1	
	int 10h			
	inc cx		
	jmp Drawmove1	
	Cmove1:
	inc si
	mov di,ds:[si]
	and di,0ffh
	cmp di,0ffh
	jz DrawmoveEnd
	Drawmove2:   
	add cx,di
	jmp DrawmoveA		
	DrawmoveEnd:
	inc dx
	pop co bp di  
	push di bp co
	mov cx,di
	cmp dx,bp
	jc notreturnmove
	jmp returnmove1
	notreturnmove:
	jmp DrawmoveA	 
	move1:		
	pop bx 	  
	inc bx
	cmp bx,1 
	jnz c2move	   
	push ax bx di       	   
	mov ax,ds:[si]
	and ax,0ffh
	cmp ax,0h 
	jnz c1move
	pop di bx ax    
	dec bx  
	push bx  
	jmp returnmove
	c1move:	   
	mov bx,offset whiteorblack
	mov di,ds:[bx]
	and di,0ffh
	cmp di,1
	jz c1moveA
	cmp ax,10h
	jc endc1moveA
	pop di bx ax    
	dec bx  
	push bx  
	jmp returnmove   
	c1moveA:
	cmp ax,10h
	jnc endc1moveA
	pop di bx ax    
	dec bx  
	push bx  
	jmp returnmove  	   
	endc1moveA:	   
	pop di bx ax   
	c2move:   
	cmp bx,2
	jnz notmove2
	jmp move2
	notmove2:
	push ax bx si 	  
	mov ax,ds:[si]
	and ax,0ffh
	sub si,offset chessboard2
	mov bx,0
	c2moveloop:
	add bx,length1  
	sub si,length1 
	jnc c2moveloop
	add si,length1
	sub bx,length1  
	cmp ax,01h
	jnz Cvmove
	call FunctionPawn                     
	Cvmove:
	cmp ax,02h
	jnz Cv1move
	call  FunctionBishop              
	Cv1move:
	cmp ax,03h
	jnz Cv2move 
	call FunctionKnight  	         
	Cv2move:
	cmp ax,05h
	jnz Cv3move
	call FunctionRook  	                                        
	Cv3move: 
	cmp ax,08h
	jnz Cv4move
	call FunctionQueen                    
	Cv4move:
	cmp ax,09h
	jnz Cv5move
	call FunctionKing		
	Cv5move:
	cmp ax,0a1h
	jnz Cvbmove
	call FunctionPawnB
	Cvbmove:
	cmp ax,0a2h
	jnz Cv1bmove
	call FunctionBishopB 
	Cv1bmove:
	cmp ax,0a3h
	jnz Cv2bmove
	call FunctionKnightB
	Cv2bmove:
	cmp ax,0a5h
	jnz Cv3bmove
	call FunctionRookB
	Cv3bmove:
	cmp ax,0a8h
	jnz Cv4bmove
	call FunctionQueenB
	Cv4bmove:
	cmp ax,0a9h
	jnz Cv5bbmove
	call FunctionKingB
	Cv5bbmove:
	pop si bx ax 	   
	push si 
	push bx 
	jmp returnmove
	move2:
	push ax si
	sub si,offset chessboard2
	add si,offset chessboard
	mov ax,ds:[si]
	and ax,0ffh
	cmp ax,4h           
	jz endmove2
	;  cmp ax,0
	; jz endmove3A
	;   pop si ax 
	;   mov bx,0 
	;  push bx 
	;  jmp returnmove 
	;endmove3A:
	pop si ax 
	dec bx  
	push bx 
	jmp returnmove
	endmove2: 
	pop si ax 
	pop bx 
	mov ch,ds:[si]
	mov cl,ds:[bx]
	mov ds:[si],cl 
	mov al,0
	mov ds:[bx],al 
	call delete4
	push bx di  
	mov bx,offset whiteorblack 
	mov di,ds:[bx]
	cmp di,1 
	jz whiteorblack1 
	mov ds:[bx],di
	push co 
	call checkW
	pop ax 
	jmp whiteorblack2
	whiteorblack1:
	push co 
	call checkB
	pop ax 
	whiteorblack2:
	pop di bx 
	cmp ax,0 
	jz endmove3        
	mov cl,ds:[si]
	mov ds:[bx],cl 
	mov ds:[si],ch 
	call delete4
	mov bx,0
	push bx 
	jmp returnmove
	endmove3:
	sub bx,offset chessboard2
	sub si,offset chessboard2
	push cx bx si
	call lastmove
	pop co co co 
	pop di si bp dx cx bx ax 	
	ret 	   
movefunction endp
; -----------------------------------------------------------------------------------------------
delete4 proc 
	push si bx ax 
	mov bx,offset chessboard
	mov si,offset chessboard2
	loopdelete4:
	  mov al,ds:[si]
	  mov ds:[bx],al 
	  inc bx 
	  inc si
	  cmp si,offset aEnd2
	  jc loopdelete4
	pop ax bx si 
	ret 
delete4 endp  
; -----------------------------------------------------------------------------------------------
everysituation proc  
	push bp
	mov bp,sp
	push ax bx cx dx di si  
	mov dx,ss:[bp+4]         ; max player or min player  
	mov di,dx
	and di,0ffh
	and dx,0ff00h
	mov cl,8 
	ror dx,cl
	mov bx,offset chessboard 
	mov si,0	 
	cmp dx,0 
	jnz everysituationplayer1
	jmp everysituationplayer2
	everysituationplayer1A:
	inc si 
	cmp si,length1
	jc everysituationplayer1
	mov si,0 
	add bx,length1
	everysituationplayer1:
	mov ch,ds:[si][bx] 
	cmp ch,01h
	jnz noteverysituationpawne
	jmp everysituationpawne
	noteverysituationpawne:
	cmp ch,02h
	jnz noteverysituationBishope
	jmp everysituationBishope
	noteverysituationBishope:
	cmp ch,03h
	jnz noteverysituationKnighte
	jmp everysituationKnighte
	noteverysituationKnighte:
	cmp ch,05h
	jnz noteverysituationrooke
	jmp everysituationrooke
	noteverysituationrooke:
	cmp ch,08h
	jnz noteverysituationqueen
	jmp everysituationqueene
	noteverysituationqueen:
	cmp ch,09h
	jnz noteverysituationkinge
	jmp everysituationkinge	 
	noteverysituationkinge:
	inc si 
	cmp si,length1
	jc everysituationplayer1 
	mov si,0
	add bx,length1
	cmp bx,offset aEnd1 
	jc everysituationplayer1
	mov dl,0ffh
	mov ss:[bp+4],dl                     
	jmp endeverysituation
	everysituationpawne:
	push bx si 	   
	cmp bx,106Dh                                                              ;----------------- herepromotingwhite
	jnz notpawnepromoting
	jmp pawnepromoting
	notpawnepromoting:
	mov dl,ds:[bx-length1][si]  
	cmp dl,0
	jnz pawne3 
	sub bx,length1 
	dec di 
	cmp di,0 
	jnz qpawne3
	call everysituationcheckwhite 
	qpawne3: 
	add bx,length1	
	cmp bx,1095h
	jnz pawne3
	mov dl,ds:[bx-length1-length1][si]
	cmp dl,0
	jnz pawne3
	sub bx,length1
	sub bx,length1
	dec di 
	cmp di,0 
	jnz qpawne3a
	call everysituationcheckwhite 
	qpawne3a:
	add bx,length1
	add bx,length1
	pawne3:
	inc si 
	cmp si,length1
	jnc pawne1
	mov dl,[bx-length1][si]
	cmp dl,10h
	jc pawne1
	sub bx,length1 
	dec di 
	cmp di,0 
	jnz qpawne3B
	call everysituationcheckwhite 
	qpawne3B: 
	add bx,length1	      
	pawne1:
	sub si,1 

	sub si,1 
	jc pawne2
	mov dl,[bx-length1][si]
	cmp dl,10h
	jc pawne2
	sub bx,length1 
	dec di 
	cmp di,0 
	jnz qpawne3C
	call everysituationcheckwhite 
	qpawne3C: 
	inc si 
	add bx,length1
	pawne2:
	pop si bx 
	jmp everysituationplayer1A
	pawnepromoting:
	mov dl,ds:[bx-length1][si]  
	cmp dl,0
	jz notpawnepromoting2
	jmp pawnepromoting2
	notpawnepromoting2:
	mov dl,1h
	mov dh,0 
	mov ds:[bx-length1][si],dl
	mov ds:[bx][si],dh	
	push co 
	call checkW 
	pop ax
	cmp ax,1 
	jnz promotetoqueen	   
	mov ds:[bx][si],dl
	mov ds:[bx-length1][si],dh	
	jmp pawnepromoting2
	promotetoqueen:
	dec di 
	cmp di,0 
	jnz promotetorook 
	mov dl,9h
	mov ds:[bx-length1][si],dl	    
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,0h
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	  
	promotetorook:	   
	dec di 
	cmp di,0 
	jnz promotetoknight
	mov dl,5h
	mov ds:[bx-length1][si],dl   
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,0h
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promotetoknight:	
	dec di 
	cmp di,0 
	jnz promotetobishop
	mov dl,3h
	mov ds:[bx-length1][si],dl    
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,0h
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promotetobishop:
	dec di 
	cmp di,0 
	jnz pawnepromoting2A
	mov dl,2h
	mov ds:[bx-length1][si],dl 
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	push bx si  
	mov si,ax 
	mov ch,0h
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	pawnepromoting2A:	  
	mov ds:[bx][si],dl
	mov ds:[bx-length1][si],dh
	pawnepromoting2:
	inc si 
	cmp si,length1
	jc notpawnepromoting3
	jmp pawnepromoting3
	notpawnepromoting3:
	mov cl,[bx-length1][si]
	mov dl,[bx-length1][si]
	cmp dl,10h
	jnc notpawnepromoting3A
	jmp pawnepromoting3
	notpawnepromoting3A:
	mov dl,1h
	mov dh,0 
	mov ds:[bx-length1][si],dl
	mov ds:[bx][si-1],dh	
	push co 
	call checkW 
	pop ax
	cmp ax,1 
	jnz promotetoqueen1	   
	mov ds:[bx][si-1],dl
	mov ds:[bx-length1][si],cl
	jmp pawnepromoting3
	promotetoqueen1:
	dec di 
	cmp di,0 
	jnz promotetorook1
	mov dl,9h
	mov ds:[bx-length1][si],dl	  
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promotetorook1:	   
	dec di 
	cmp di,0 
	jnz promotetoknight1
	mov dl,5h
	mov ds:[bx-length1][si],dl   
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx   
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promotetoknight1:	
	dec di 
	cmp di,0 
	jnz promotetobishop1
	mov dl,3h
	mov ds:[bx-length1][si],dl	   
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx  
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promotetobishop1:
	dec di 
	cmp di,0 
	jnz pawnepromoting3A
	mov dl,2h
	mov ds:[bx-length1][si],dl	  
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	pawnepromoting3A:
	mov ds:[bx][si-1],dl
	mov ds:[bx-length1][si],cl	   
	pawnepromoting3:
	sub si,1    
	sub si,1 
	jnc notendpromoting
	jmp endpromoting
	notendpromoting:
	mov cl,[bx-length1][si]
	mov dl,[bx-length1][si]
	cmp dl,10h
	jnc notendpromoting1
	jmp endpromoting
	notendpromoting1:
	mov dl,1h
	mov dh,0 
	mov ds:[bx-length1][si],dl
	mov ds:[bx][si+1],dh	
	push co 
	call checkW 
	pop ax
	cmp ax,1 
	jnz promotetoqueen2	   
	mov ds:[bx][si+1],dl
	mov ds:[bx-length1][si],cl
	jmp endpromoting
	promotetoqueen2:
	dec di 
	cmp di,0 
	jnz promotetorook2
	mov dl,9h
	mov ds:[bx-length1][si],dl	     
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	promotetorook2:	   
	dec di 
	cmp di,0 
	jnz promotetoknight2
	mov dl,5h
	mov ds:[bx-length1][si],dl
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx   
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	promotetoknight2:	
	dec di 
	cmp di,0 
	jnz promotetobishop2
	mov dl,3h
	mov ds:[bx-length1][si],dl     
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx  
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	promotetobishop2:
	dec di 
	cmp di,0 
	jnz endpromotingA
	mov dl,2h
	mov ds:[bx-length1][si],dl      
	sub bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	endpromotingA:
	mov ds:[bx][si+1],dl
	mov ds:[bx-length1][si],cl
	endpromoting:	   
	pop si bx 
	jmp everysituationplayer1A	
	everysituationBishope:
	push bx si 
	mov ax,0 
	inc di  
	loopBishope:
	dec di 
	cmp di,0 
	jnz c1Bishope
	call everysituationcheckwhite 
	c1Bishope:
	cmp ax,1
	jz Bishopeoption1
	cmp ax,2
	jz Bishopeoption2
	cmp ax,3
	jz Bishopeoption3
	inc si
	add bx,length1
	cmp si,length1
	jnc cBishope		
	cmp bx,offset aEnd1 
	jnc cBishope
	jmp Bishopebegin1
	Bishopeoption1: 
	add bx,length1
	sub si,1
	jc cBishope
	cmp bx,offset aEnd1 
	jnc cBishope
	jmp Bishopebegin1
	Bishopeoption2:
	inc si
	sub bx,length1
	cmp si,length1
	jnc cBishope
	cmp bx,offset beginoff
	jc cBishope 
	jmp Bishopebegin1
	Bishopeoption3:
	sub si,1
	jc cBishope
	sub bx,length1
	cmp bx,offset beginoff
	jc cBishope
	Bishopebegin1:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz loopBishope
	cmp dl,10h
	jc cBishope
	dec di 
	cmp di,0 
	jnz cBishope
	call everysituationcheckwhite 
	cBishope:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endBishope
	inc di 
	jmp loopBishope
	endBishope :	
	pop si bx 
	jmp everysituationplayer1A
	everysituationKnighte:
	push bx si 
	add bx,length1  
	add bx,length1
	inc si 			 
	cmp bx,offset aEnd1 
	jnc Knighte1a
	cmp si,length1 
	jnc Knighte1a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knighte1
	cmp dl,10h
	jc Knighte1a
	Knighte1:    
	dec di 
	cmp di,0 
	jnz Knighte1a
	call everysituationcheckwhite  
	Knighte1a:
	sub bx,length1  ;1
	sub bx,length1
	sub si,1	 
	sub bx,length1  ;2
	sub bx,length1
	inc si 		 
	cmp bx, offset beginoff
	jc Knighte2a
	cmp si,length1 
	jnc Knighte2a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knighte2
	cmp dl,10h
	jc Knighte2a
	Knighte2: 
	dec di 
	cmp di,0 
	jnz Knighte2a
	call everysituationcheckwhite  
	Knighte2a:
	add bx,length1  ;2
	add bx,length1
	sub si,1 	 
	add bx,length1;3 
	add bx,length1	 
	sub si,1
	jc Knighte3a
	cmp bx, offset aEnd1 
	jnc Knighte3a			 
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knighte3
	cmp dl,10h
	jc Knighte3a
	Knighte3: 
	dec di 
	cmp di,0 
	jnz Knighte3a
	call everysituationcheckwhite 
	Knighte3a:
	sub bx,length1;3 
	sub bx,length1	 
	inc si    		 
	add bx,length1   ;4
	sub si,2 
	jc Knighte4a
	cmp bx,offset aEnd1 
	jnc Knighte4a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knighte4
	cmp dl,10h
	jc Knighte4a
	Knighte4: 
	dec di 
	cmp di,0 
	jnz Knighte4a
	call everysituationcheckwhite 
	Knighte4a: 
	sub bx,length1   ;4
	add si,2  
	add bx,length1;5
	add si,2 
	cmp si,length1
	jnc Knighte5a
	cmp bx,offset aEnd1 
	jnc Knighte5a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knighte5
	cmp dl,10h
	jc Knighte5a
	Knighte5: 
	dec di 
	cmp di,0 
	jnz Knighte5a
	call everysituationcheckwhite 
	Knighte5a: 
	sub bx,length1;5
	sub si,2 
	sub bx,length1;6
	sub si,2 
	jc Knighte6a
	cmp bx,offset beginoff
	jc Knighte6a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knighte6
	cmp dl,10h
	jc Knighte6a
	Knighte6: 
	dec di 
	cmp di,0 
	jnz Knighte6a
	call everysituationcheckwhite 
	Knighte6a: 
	add bx,length1;6
	add si,2  	 
	sub bx,length1;7
	add si,2 
	cmp si,length1
	jnc Knighte7a
	cmp bx,offset beginoff
	jc Knighte7a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knighte7
	cmp dl,10h
	jc Knighte7a
	Knighte7: 
	dec di 
	cmp di,0 
	jnz Knighte7a
	call everysituationcheckwhite 
	Knighte7a: 
	add bx,length1;7
	sub si,2 
	sub bx,length1;9
	sub bx,length1
	sub si,1 
	jc Knighte9a
	cmp bx,offset beginoff
	jc Knighte9a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz Knighte9
	cmp dl,10h
	jc Knighte9a
	Knighte9: 
	dec di 
	cmp di,0 
	jnz Knighte9a
	call everysituationcheckwhite 
	Knighte9a: 
	add bx,length1;9
	add bx,length1
	inc si
	pop si bx 
	jmp everysituationplayer1A
	everysituationrooke:
	push bx si
	mov ax,0 	   
	inc di 		  
	looprocke:
	dec di 
	cmp di,0 
	jnz c1rocke
	call everysituationcheckwhite 
	c1rocke:
	cmp ax,1
	jz rockeoption1
	cmp ax,2
	jz rockeoption2
	cmp ax,3
	jz rockeoption3
	inc si
	cmp si,length1
	jnc crocke
	jmp beginrocke
	rockeoption1:
	cmp si,0
	jz crocke
	sub si,1 
	jmp beginrocke
	rockeoption2:
	add bx,length1
	cmp bx,offset aEnd1 
	jnc crocke 
	jmp beginrocke
	rockeoption3:
	sub bx,length1
	cmp bx,offset beginoff
	jc crocke 
	beginrocke:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz looprocke
	cmp dl,10h
	jc crocke
	dec di 
	cmp di,0 
	jnz crocke
	call everysituationcheckwhite 
	crocke:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endrocke 
	inc di 
	jmp looprocke 
	endrocke :	
	pop si bx 
	jmp everysituationplayer1A
	everysituationkinge:
	push bx si 
	inc si 
	cmp si,length1
	jnc kinge1A
	mov al,ds:[bx][si]
	cmp al,0
	jz kinge1
	cmp al,10h
	jc kinge1A  
	kinge1:  
	dec di 
	cmp di,0 
	jnz kinge1A
	call everysituationcheckwhite 
	kinge1A:
	sub si,1 

	sub si,1  
	jc kinge2A
	mov al,ds:[bx][si]
	cmp al,0
	jz kinge2
	cmp al,10h
	jc kinge2A  
	kinge2:  
	dec di 
	cmp di,0 
	jnz kinge2A
	call everysituationcheckwhite 
	kinge2A:
	inc si 

	add bx,length1
	cmp bx,offset aEnd1 
	jnc kinge3A 
	mov al,ds:[bx][si]
	cmp al,0
	jz kinge3
	cmp al,10h
	jc kinge3A  
	kinge3:  
	dec di 
	cmp di,0 
	jnz kinge3A
	call everysituationcheckwhite 
	kinge3A:
	sub bx,length1

	sub bx,length1 
	cmp bx,offset beginoff 
	jc kinge4A 

	mov al,ds:[bx][si]
	cmp al,0
	jz kinge4
	cmp al,10h
	jc kinge4A  
	kinge4:  
	dec di 
	cmp di,0 
	jnz kinge4A
	call everysituationcheckwhite 
	kinge4A:
	add bx,length1 

	add bx,length1
	inc si
	cmp bx,offset aEnd1 
	jnc kinge5A 
	cmp si,length1
	jnc  kinge5A 

	mov al,ds:[bx][si]
	cmp al,0
	jz kinge5
	cmp al,10h
	jc kinge5A  
	kinge5:  
	dec di 
	cmp di,0 
	jnz kinge5A
	call everysituationcheckwhite 
	kinge5A:
	sub bx,length1
	sub si,1

	add bx,length1
	sub si,1
	jc kinge6A 
	cmp bx,offset aEnd1 
	jnc kinge6A 

	mov al,ds:[bx][si]
	cmp al,0
	jz kinge6
	cmp al,10h
	jc kinge6A  
	kinge6:  
	dec di 
	cmp di,0 
	jnz kinge6A
	call everysituationcheckwhite 
	kinge6A:
	sub bx,length1
	inc si

	sub bx,length1
	inc si 
	cmp bx,offset beginoff
	jc kinge7A 
	cmp si,length1
	jnc kinge7A 


	mov al,ds:[bx][si]
	cmp al,0
	jz kinge7
	cmp al,10h
	jc kinge7A  
	kinge7:  
	dec di 
	cmp di,0 
	jnz kinge7A
	call everysituationcheckwhite 
	kinge7A:
	add bx,length1
	sub si,1 

	sub bx,length1
	sub si,1 
	jc kinge8A
	cmp bx,offset beginoff
	jc kinge8A 

	mov al,ds:[bx][si]
	cmp al,0
	jz kinge8
	cmp al,10h
	jc kinge8A  
	kinge8:  
	dec di 
	cmp di,0 
	jnz kinge8A
	call everysituationcheckwhite 
	kinge8A:
	add bx,length1
	inc si     
	mov bx,offset movementking                        ;------herecastlewhite 
	mov ax,ds:[bx]
	cmp ax,0
	jz notendcastlingW
	jmp endcastlingW
	notendcastlingW:
	mov bx,offset movementleftrook
	mov al,ds:[bx]
	cmp al,0
	jz notlongcastle2
	jmp longcastle
	notlongcastle2:
	push co 
	call checkW
	pop ax 
	cmp ax,1
	jnz notendcastlingW1
	jmp endcastlingW
	notendcastlingW1:
	pop si bx 
	push bx si 
	mov al,ds:[bx][si+1]
	cmp al,0 
	jz notlongcastle5
	jmp longcastle
	notlongcastle5:
	mov al,ds:[bx][si+2]
	cmp al,0 
	jz notlongcastle6
	jmp longcastle
	notlongcastle6:
	mov ah,9h
	mov al,0 
	mov ds:[bx][si+1],ah
	mov ds:[bx][si],al
	push co 
	call checkW
	pop ax 
	cmp ax,1
	jnz notlongcastle
	mov ah,9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si+1],al
	jmp longcastle
	notlongcastle:
	mov ah,9h
	mov al,0 
	mov ds:[bx][si+2],ah
	mov ds:[bx][si+1],al
	push co 
	call checkW
	pop ax 
	cmp ax,1
	jnz notlongcastle1
	mov ah,9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si+2],al
	jmp longcastle
	notlongcastle1:
	dec di 
	cmp di,0 
	jz notendcastlingW7
	mov ah,9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si+2],al
	jmp longcastle
	notendcastlingW7: 
	mov cx,0f1f1h
	mov bx,0f1h 
	mov si,0f1h
	push cx bx si   
	call lastmove
	pop co co co
	pop si bx  
	mov ah,05h
	mov ds:[bx][si+3],al
	mov ds:[bx][si+1],ah 
	mov bx,offset castle
	mov ax,1 
	mov ds:[bx],ax 
	jmp endeverysituation 
	longcastle:
	mov bx,offset movementrightrook
	mov ax,ds:[bx]
	cmp ax,0
	jz notendcastlingW2
	jmp endcastlingW
	notendcastlingW2:
	push co 
	call checkW
	pop ax 
	cmp ax,1
	jnz notendcastlingW3
	jmp endcastlingW
	notendcastlingW3:
	pop si bx 
	push bx si  
	mov al,ds:[bx][si-1]
	cmp al,0 
	jz notendcastlingW4
	jmp endcastlingW
	notendcastlingW4:
	mov al,ds:[bx][si-2]
	cmp al,0 
	jz notendcastlingW5
	jmp endcastlingW
	notendcastlingW5:
	mov al,ds:[bx][si-3]
	cmp al,0 
	jz notendcastlingW6
	jmp endcastlingW
	notendcastlingW6:
	mov ah,9h
	mov al,0 
	mov ds:[bx][si-1],ah
	mov ds:[bx][si],al
	push co 
	call checkW
	pop ax 
	cmp ax,1
	jnz notendcastlingW8
	mov ah,9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si-1],al
	jmp endcastlingW
	notendcastlingW8:
	mov ah,9h
	mov al,0 
	mov ds:[bx][si-2],ah
	mov ds:[bx][si-1],al
	push co 
	call checkW
	pop ax 
	cmp ax,1
	jnz notendcastlingW9
	mov ah,9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si-2],al
	jmp endcastlingW
	notendcastlingW9:
	dec di 
	cmp di,0 
	jz notendcastlingW10
	mov ah,9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si-2],al
	jmp endcastlingW
	notendcastlingW10:
	mov ah,9h
	mov al,0 
	mov ds:[bx][si-3],al
	mov ds:[bx][si],ah
	mov cx,0f2f2h
	mov bx,0f2h 
	mov si,0f2h
	push cx bx si   
	call lastmove
	pop co co co
	pop si bx  
	mov ds:[bx][si-2],ah 
	mov ds:[bx][si],al 
	mov ah,05h
	mov ds:[bx][si-4],al
	mov ds:[bx][si-1],ah
	mov bx,offset castle
	mov ax,1 
	mov ds:[bx],ax 
	jmp endeverysituation
	endcastlingW:
	pop si bx 
	jmp everysituationplayer1A
	everysituationqueene:
	push bx si 
	mov ax,0 
	inc di  
	loopqueene:
	dec di 
	cmp di,0 
	jnz c1queene
	call everysituationcheckwhite 
	c1queene:
	cmp ax,1
	jz queeneoption1
	cmp ax,2
	jz queeneoption2
	cmp ax,3
	jz queeneoption3
	inc si
	add bx,length1
	cmp si,length1
	jnc cqueene		
	cmp bx,offset aEnd1 
	jnc cqueene
	jmp queenebegin1
	queeneoption1: 
	add bx,length1
	sub si,1
	jc cqueene
	cmp bx,offset aEnd1 
	jnc cqueene
	jmp queenebegin1
	queeneoption2:
	inc si
	sub bx,length1
	cmp si,length1
	jnc cqueene
	cmp bx,offset beginoff
	jc cqueene
	jmp queenebegin1
	queeneoption3:
	sub si,1
	jc cqueene
	sub bx,length1
	cmp bx,offset beginoff
	jc cqueene
	queenebegin1:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz loopqueene
	cmp dl,10h
	jc cqueene
	dec di 
	cmp di,0 
	jnz cqueene
	call everysituationcheckwhite 
	cqueene:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endqueene
	inc di 
	jmp loopqueene
	endqueene :	
	pop si bx
	push bx si
	mov ax,0 	   
	inc di   
	loopqueenea:
	dec di 
	cmp di,0 
	jnz c1queenea
	call everysituationcheckwhite 
	c1queenea:
	cmp ax,1
	jz queeneaoption1
	cmp ax,2
	jz queeneaoption2
	cmp ax,3
	jz queeneaoption3
	inc si
	cmp si,length1
	jnc cqueenea
	jmp beginqueenea
	queeneaoption1:
	cmp si,0
	jz cqueenea
	sub si,1 
	jmp beginqueenea
	queeneaoption2:
	add bx,length1
	cmp bx,offset aEnd1 
	jnc cqueenea 
	jmp beginqueenea
	queeneaoption3:
	sub bx,length1
	cmp bx,offset beginoff
	jc cqueenea
	beginqueenea:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz loopqueenea
	cmp dl,10h
	jc cqueenea
	dec di 
	cmp di,0 
	jnz cqueenea
	call everysituationcheckwhite 
	cqueenea:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endqueenea
	inc di 
	jmp loopqueenea
	endqueenea :	
	pop si bx 
	jmp everysituationplayer1A 
	everysituationplayer2A:
	inc si 
	cmp si,length1
	jc everysituationplayer2
	mov si,0 
	add bx,length1 
	everysituationplayer2:
	mov ch,ds:[si][bx] 
	cmp ch,0a1h
	jnz noteverysituationpawneb
	jmp everysituationpawneb
	noteverysituationpawneb:	 
	cmp ch,0a2h
	jnz noteverysituationBishopeb
	jmp everysituationBishopeb
	noteverysituationBishopeb:	
	cmp ch,0a3h
	jnz noteverysituationKnighteb
	jmp everysituationKnighteb
	noteverysituationKnighteb:	 
	cmp ch,0a5h
	jnz noteverysituationrookeb
	jmp everysituationrookeb
	noteverysituationrookeb:	 
	cmp ch,0a8h
	jnz noteverysituationqueenb
	jmp everysituationqueenb
	noteverysituationqueenb:
	cmp ch,0a9h
	jnz noteverysituationkingeb 
	jmp everysituationkingeb 
	noteverysituationkingeb :
	inc si
	cmp si,length1
	jc everysituationplayer2
	mov si,0
	add bx,length1	 
	cmp bx,offset aEnd1
	jc everysituationplayer2
	mov dl,0ffh
	mov ss:[bp+4],dl    
	jmp endeverysituation
	everysituationpawneB:
	push bx si 
	cmp bx,1095h
	jnz notpawnepromotingB
	jmp pawnepromotingB
	notpawnepromotingB:
	mov dl,ds:[bx+length1][si]  
	cmp dl,0
	jnz pawneB3 
	add bx,length1 
	dec di 
	cmp di,0 
	jnz qpawneB3
	call everysituationcheckblack
	qpawneB3: 
	sub bx,length1	
	cmp bx,106Dh
	jnz pawneB3
	mov dl,ds:[bx+length1+length1][si]
	cmp dl,0
	jnz pawneB3
	add bx,length1
	add bx,length1
	dec di 
	cmp di,0 
	jnz qpawneB3a
	call everysituationcheckblack
	qpawneB3a:
	sub bx,length1
	sub bx,length1
	pawneB3:
	inc si 
	cmp si,length1
	jnc pawneB1
	mov dl,[bx+length1][si]
	cmp dl,0h
	jz pawneB1
	cmp dl,10h
	jnc pawneB1
	add bx,length1 
	dec di 
	cmp di,0 
	jnz qpawneB3B
	call everysituationcheckblack
	qpawneB3B: 
	sub bx,length1	      
	pawneB1:
	sub si,1 

	sub si,1 
	jc pawneB2
	mov dl,[bx+length1][si]
	cmp dl,0h
	jz pawneB2
	cmp dl,10h
	jnc pawneB2
	add bx,length1 
	dec di 
	cmp di,0 
	jnz qpawneB3C
	call everysituationcheckblack
	qpawneB3C: 
	inc si 
	sub bx,length1
	pawneB2:

	;------------------------enpassent
	pop si bx 
	jmp everysituationplayer2A	
	pawnepromotingB:
	mov dl,ds:[bx+length1][si]  
	cmp dl,0
	jz notpawnepromotingB2
	jmp pawnepromotingB2
	notpawnepromotingB2:
	mov dl,0a1h
	mov dh,0 
	mov ds:[bx+length1][si],dl
	mov ds:[bx][si],dh	
	push co 
	call checkB 
	pop ax
	cmp ax,1 
	jnz promoteBtoqueen	   
	mov ds:[bx][si],dl
	mov ds:[bx+length1][si],dh	
	jmp pawnepromotingB2
	promoteBtoqueen:
	dec di 
	cmp di,0 
	jnz promoteBtorook 
	mov dl,0a9h
	mov ds:[bx+length1][si],dl	    
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx  
	add bx,si 
	mov si,ax 
	mov ch,0h
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	  
	promoteBtorook:	   
	dec di 
	cmp di,0 
	jnz promoteBtoknight
	mov dl,0a5h
	mov ds:[bx+length1][si],dl   
	add bx,length1
	mov ax,si
	add ax,bx	  
	push bx si  
	add bx,si 
	mov si,ax 
	mov ch,0h
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promoteBtoknight:	
	dec di 
	cmp di,0 
	jnz promoteBtobishop
	mov dl,0a3h
	mov ds:[bx+length1][si],dl    
	add bx,length1
	mov ax,si
	add ax,bx	  
	push bx si  
	add bx,si 
	mov si,ax 
	mov ch,0h
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promoteBtobishop:
	dec di 
	cmp di,0 
	jnz pawnepromotingB2A
	mov dl,0a2h
	mov ds:[bx+length1][si],dl 
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx  
	add bx,si 
	mov si,ax 
	mov ch,0h
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	pawnepromotingB2A:	  
	mov ds:[bx][si],dl
	mov ds:[bx+length1][si],dh
	pawnepromotingB2:
	inc si 
	cmp si,length1
	jc notpawnepromotingB3
	jmp pawnepromotingB3
	notpawnepromotingB3:
	mov cl,[bx+length1][si]
	mov dl,[bx+length1][si]
	cmp dl,10h
	jc notpawnepromotingB3A
	jmp pawnepromotingB3
	notpawnepromotingB3A:
	mov dl,0a1h
	mov dh,0 
	mov ds:[bx+length1][si],dl
	mov ds:[bx][si-1],dh	
	push co 
	call checkB 
	pop ax
	cmp ax,1 
	jnz promoteBtoqueen1	   
	mov ds:[bx][si-1],dl
	mov ds:[bx+length1][si],cl
	jmp pawnepromotingB3
	promoteBtoqueen1:
	dec di 
	cmp di,0 
	jnz promoteBtorook1
	mov dl,0a9h
	mov ds:[bx+length1][si],dl	  
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx  
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promoteBtorook1:	   
	dec di 
	cmp di,0 
	jnz promoteBtoknight1
	mov dl,0a5h
	mov ds:[bx+length1][si],dl   
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promoteBtoknight1:	
	dec di 
	cmp di,0 
	jnz promoteBtobishop1
	mov dl,0a3h
	mov ds:[bx+length1][si],dl	   
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation	 
	promoteBtobishop1:
	dec di 
	cmp di,0 
	jnz pawnepromotingB3A
	mov dl,0a2h
	mov ds:[bx+length1][si],dl	  
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx  
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	pawnepromotingB3A:
	mov ds:[bx][si-1],dl
	mov ds:[bx+length1][si],cl	   
	pawnepromotingB3:
	sub si,1    
	sub si,1 
	jnc notendpromotingB
	jmp endpromotingB
	notendpromotingB:
	mov cl,[bx+length1][si]
	mov dl,[bx+length1][si]
	cmp dl,10h
	jc notendpromotingB1
	jmp endpromotingB
	notendpromotingB1:
	mov dl,0a1h
	mov dh,0 
	mov ds:[bx+length1][si],dl
	mov ds:[bx][si+1],dh	
	push co 
	call checkB 
	pop ax
	cmp ax,1 
	jnz promoteBtoqueen2	   
	mov ds:[bx][si+1],dl
	mov ds:[bx+length1][si],cl
	jmp endpromotingB
	promoteBtoqueen2:
	dec di 
	cmp di,0 
	jnz promoteBtorook2
	mov dl,0a9h
	mov ds:[bx+length1][si],dl	     
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx   
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	promoteBtorook2:	   
	dec di 
	cmp di,0 
	jnz promoteBtoknight2
	mov dl,0a5h
	mov ds:[bx+length1][si],dl
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx  
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	promoteBtoknight2:	
	dec di 
	cmp di,0 
	jnz promoteBtobishop2
	mov dl,0a3h
	mov ds:[bx+length1][si],dl     
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx 
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	promoteBtobishop2:
	dec di 
	cmp di,0 
	jnz endpromotingBA
	mov dl,0a2h
	mov ds:[bx+length1][si],dl      
	add bx,length1
	mov ax,si
	add ax,bx	  
	pop si bx  
	add bx,si 
	mov si,ax 
	mov ch,cl 
	mov cl,0a1h
	sub bx,offset chessboard
	sub si,offset chessboard
	push cx bx si   
	call lastmove
	pop co co co
	jmp endeverysituation
	endpromotingBA:
	mov ds:[bx][si+1],dl
	mov ds:[bx+length1][si],cl
	endpromotingB:	   
	pop si bx 
	jmp everysituationplayer2A
	everysituationBishopeB:
	push bx si 
	mov ax,0 
	inc di 
	loopBishopeB:
	dec di 
	cmp di,0 
	jnz c1BishopeB
	call everysituationcheckblack
	c1BishopeB:
	cmp ax,1
	jz BishopeBoption1
	cmp ax,2
	jz BishopeBoption2
	cmp ax,3
	jz BishopeBoption3
	inc si
	add bx,length1
	cmp si,length1
	jnc cBishopeB		
	cmp bx,offset aEnd1 
	jnc cBishopeB
	jmp BishopeBbegin1
	BishopeBoption1: 
	add bx,length1
	sub si,1
	jc cBishopeB
	cmp bx,offset aEnd1 
	jnc cBishopeB
	jmp BishopeBbegin1
	BishopeBoption2:
	inc si
	sub bx,length1
	cmp si,length1
	jnc cBishopeB
	cmp bx,offset beginoff
	jc cBishopeB 
	jmp BishopeBbegin1
	BishopeBoption3:
	sub si,1
	jc cBishopeB
	sub bx,length1
	cmp bx,offset beginoff
	jc cBishopeB
	BishopeBbegin1:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz loopBishopeB
	cmp dl,10h
	jnc cBishopeB
	dec di 
	cmp di,0 
	jnz cBishopeB
	call everysituationcheckblack
	cBishopeB:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endBishopeB
	inc di 
	jmp loopBishopeB
	endBishopeB :	
	pop si bx 
	jmp everysituationplayer2A
	everysituationKnighteB:
	push bx si 
	add bx,length1  
	add bx,length1
	inc si 			 
	cmp bx,offset aEnd1
	jnc KnighteB1a
	cmp si,length1 
	jnc KnighteB1a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz KnighteB1
	cmp dl,10h
	jnc KnighteB1a
	KnighteB1:    
	dec di 
	cmp di,0 
	jnz KnighteB1a
	call everysituationcheckblack
	KnighteB1a:
	sub bx,length1  ;1
	sub bx,length1
	sub si,1	 
	sub bx,length1  ;2
	sub bx,length1
	inc si 		 
	cmp bx, offset beginoff
	jc KnighteB2a
	cmp si,length1 
	jnc KnighteB2a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz KnighteB2
	cmp dl,10h
	jnc KnighteB2a
	KnighteB2: 
	dec di 
	cmp di,0 
	jnz KnighteB2a
	call everysituationcheckblack
	KnighteB2a:
	add bx,length1  ;2
	add bx,length1
	sub si,1 	 
	add bx,length1;3 
	add bx,length1	 
	sub si,1 
	jc KnighteB3a
	cmp bx,offset aEnd1
	jnc KnighteB3a			 
	mov dl,ds:[bx][si]
	cmp dl,0
	jz KnighteB3
	cmp dl,10h
	jnc KnighteB3a
	KnighteB3: 
	dec di 
	cmp di,0 
	jnz KnighteB3a
	call everysituationcheckblack
	KnighteB3a:
	sub bx,length1;3 
	sub bx,length1	 
	inc si    		 
	add bx,length1   ;4
	sub si,2 
	jc KnighteB4a
	cmp bx,offset aEnd1
	jnc KnighteB4a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz KnighteB4
	cmp dl,10h
	jnc KnighteB4a
	KnighteB4: 
	dec di 
	cmp di,0 
	jnz KnighteB4a
	call everysituationcheckblack
	KnighteB4a: 
	sub bx,length1   ;4
	add si,2  
	add bx,length1;5
	add si,2 
	cmp si,length1
	jnc KnighteB5a
	cmp bx,offset aEnd1
	jnc KnighteB5a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz KnighteB5
	cmp dl,10h
	jnc KnighteB5a
	KnighteB5: 
	dec di 
	cmp di,0 
	jnz KnighteB5a
	call everysituationcheckblack 
	KnighteB5a: 
	sub bx,length1;5
	sub si,2 
	sub bx,length1;6
	sub si,2 
	jc KnighteB6a
	cmp bx,offset beginoff
	jc KnighteB6a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz KnighteB6
	cmp dl,10h
	jnc KnighteB6a
	KnighteB6: 
	dec di 
	cmp di,0 
	jnz KnighteB6a
	call everysituationcheckblack
	KnighteB6a: 
	add bx,length1;6
	add si,2  	 
	sub bx,length1;7
	add si,2 
	cmp si,length1
	jnc KnighteB7a
	cmp bx,offset beginoff
	jc KnighteB7a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz KnighteB7
	cmp dl,10h
	jnc KnighteB7a
	KnighteB7: 
	dec di 
	cmp di,0 
	jnz KnighteB7a
	call everysituationcheckblack 
	KnighteB7a: 
	add bx,length1;7
	sub si,2 
	sub bx,length1;9
	sub bx,length1
	sub si,1 
	jc KnighteB9a
	cmp bx,offset beginoff
	jc KnighteB9a
	mov dl,ds:[bx][si]
	cmp dl,0
	jz KnighteB9
	cmp dl,10h
	jnc KnighteB9a
	KnighteB9: 
	dec di 
	cmp di,0 
	jnz KnighteB9a
	call everysituationcheckblack
	KnighteB9a: 
	add bx,length1;9
	add bx,length1
	inc si
	pop si bx 
	jmp everysituationplayer2A
	everysituationrookeB:
	push bx si
	mov ax,0 	   
	inc di		  
	looprookeB:
	dec di 
	cmp di,0 
	jnz c1rookeB
	call everysituationcheckblack
	c1rookeB:
	cmp ax,1
	jz rookeBoption1
	cmp ax,2
	jz rookeBoption2
	cmp ax,3
	jz rookeBoption3
	inc si
	cmp si,length1
	jnc crookeB
	jmp beginrookeB
	rookeBoption1:
	cmp si,0
	jz crookeB
	sub si,1 
	jmp beginrookeB
	rookeBoption2:
	add bx,length1
	cmp bx,offset aEnd1
	jnc crookeB 
	jmp beginrookeB
	rookeBoption3:
	sub bx,length1
	cmp bx,offset beginoff
	jc crookeB 
	beginrookeB:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz looprookeB
	cmp dl,10h
	jnc crookeB
	dec di 
	cmp di,0 
	jnz crookeB
	call everysituationcheckblack
	crookeB:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endrookeB 
	inc di 
	jmp looprookeB 
	endrookeB :	
	pop si bx 
	jmp everysituationplayer2A
	everysituationkingeb:
	push bx si 
	inc si 
	cmp si,length1
	jnc kingeb1A
	mov al,ds:[bx][si]
	cmp al,0
	jz kingeb1
	cmp al,10h
	jnc kingeb1A  
	kingeb1:  
	dec di 
	cmp di,0 
	jnz kingeb1A
	call everysituationcheckblack
	kingeb1A:
	sub si,1 

	sub si,1  
	jc kingeb2A
	mov al,ds:[bx][si]
	cmp al,0
	jz kingeb2
	cmp al,10h
	jnc kingeb2A  
	kingeb2:  
	dec di 
	cmp di,0 
	jnz kingeb2A
	call everysituationcheckblack
	kingeb2A:
	inc si 

	add bx,length1
	cmp bx,offset aEnd1
	jnc kingeb3A 
	mov al,ds:[bx][si]
	cmp al,0
	jz kingeb3
	cmp al,10h
	jnc kingeb3A  
	kingeb3:  
	dec di 
	cmp di,0 
	jnz kingeb3A
	call everysituationcheckblack
	kingeb3A:
	sub bx,length1

	sub bx,length1 
	cmp bx,offset beginoff 
	jc kingeb4A 

	mov al,ds:[bx][si]
	cmp al,0
	jz kingeb4
	cmp al,10h
	jnc kingeb4A  
	kingeb4:  
	dec di 
	cmp di,0 
	jnz kingeb4A
	call everysituationcheckblack
	kingeb4A:
	add bx,length1 

	add bx,length1
	inc si
	cmp bx,offset aEnd1 
	jnc kingeb5A 
	cmp si,length1
	jnc  kingeb5A 

	mov al,ds:[bx][si]
	cmp al,0
	jz kingeb5
	cmp al,10h
	jnc kingeb5A  
	kingeb5:  
	dec di 
	cmp di,0 
	jnz kingeb5A
	call everysituationcheckblack
	kingeb5A:
	sub bx,length1
	sub si,1

	add bx,length1
	sub si,1
	jc kingeb6A 
	cmp bx,offset aEnd1
	jnc kingeb6A 

	mov al,ds:[bx][si]
	cmp al,0
	jz kingeb6
	cmp al,10h
	jnc kingeb6A  
	kingeb6:  
	dec di 
	cmp di,0 
	jnz kingeb6A
	call everysituationcheckblack
	kingeb6A:
	sub bx,length1
	inc si

	sub bx,length1
	inc si 
	cmp bx,offset beginoff
	jc kingeb7A 
	cmp si,length1
	jnc kingeb7A 


	mov al,ds:[bx][si]
	cmp al,0
	jz kingeb7
	cmp al,10h
	jnc kingeb7A  
	kingeb7:  
	dec di 
	cmp di,0 
	jnz kingeb7A
	call everysituationcheckblack
	kingeb7A:
	add bx,length1
	sub si,1 

	sub bx,length1
	sub si,1 
	jc kingeb8A
	cmp bx,offset beginoff
	jc kingeb8A 

	mov al,ds:[bx][si]
	cmp al,0
	jz kingeb8
	cmp al,10h
	jnc kingeb8A  
	kingeb8:  
	dec di 
	cmp di,0 
	jnz kingeb8A
	call everysituationcheckblack
	kingeb8A:
	add bx,length1
	inc si 
	mov bx,offset movementkingB                                    
	mov ax,ds:[bx]
	cmp ax,0
	jz notendcastlingB
	jmp endcastlingB
	notendcastlingB:
	mov bx,offset movementleftrookB
	mov al,ds:[bx]
	cmp al,0
	jz notlongcastle2B
	jmp longcastleB
	notlongcastle2B:
	push co 
	call checkB
	pop ax 
	cmp ax,1
	jnz notendcastlingB1
	jmp endcastlingB
	notendcastlingB1:
	pop si bx 
	push bx si 
	mov al,ds:[bx][si+1]
	cmp al,0 
	jz notlongcastle5B
	jmp longcastleB
	notlongcastle5B:
	mov al,ds:[bx][si+2]
	cmp al,0 
	jz notlongcastle6B
	jmp longcastleB
	notlongcastle6B:
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si+1],ah
	mov ds:[bx][si],al
	push co 
	call checkB
	pop ax 
	cmp ax,1
	jnz notlongcastleB
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si+1],al
	jmp longcastleB
	notlongcastleB:
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si+2],ah
	mov ds:[bx][si+1],al
	push co 
	call checkB
	pop ax 
	cmp ax,1
	jnz notlongcastle1B
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si+2],al
	jmp longcastleB
	notlongcastle1B:
	dec di 
	cmp di,0 
	jz notendcastlingB7
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si+2],al
	jmp longcastleB
	notendcastlingB7: 
	mov cx,0f3f3h
	mov bx,0f3h 
	mov si,0f3h
	push cx bx si   
	call lastmove
	pop co co co
	pop si bx    
	mov ah,0a5h
	mov ds:[bx][si+3],al
	mov ds:[bx][si+1],ah 
	mov bx,offset castleB
	mov ax,1 
	mov ds:[bx],ax 
	jmp endeverysituation 
	longcastleB:
	mov bx,offset movementrightrookB
	mov ax,ds:[bx]
	cmp ax,0
	jz notendcastlingB2
	jmp endcastlingB
	notendcastlingB2:
	push co 
	call checkB
	pop ax 
	cmp ax,1
	jnz notendcastlingB3
	jmp endcastlingB
	notendcastlingB3:
	pop si bx 
	push bx si  
	mov al,ds:[bx][si-1]
	cmp al,0 
	jz notendcastlingB4
	jmp endcastlingB
	notendcastlingB4:
	mov al,ds:[bx][si-2]
	cmp al,0 
	jz notendcastlingB5
	jmp endcastlingB
	notendcastlingB5:
	mov al,ds:[bx][si-3]
	cmp al,0 
	jz notendcastlingB6
	jmp endcastlingB
	notendcastlingB6:
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si-1],ah
	mov ds:[bx][si],al
	push co 
	call checkB
	pop ax 
	cmp ax,1
	jnz notendcastlingB8
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si-1],al
	jmp endcastlingB
	notendcastlingB8:
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si-2],ah
	mov ds:[bx][si-1],al
	push co 
	call checkB
	pop ax 
	cmp ax,1
	jnz notendcastlingB9
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si-2],al
	jmp endcastlingB
	notendcastlingB9:
	dec di 
	cmp di,0 
	jz notendcastlingB10
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si-2],al
	jmp endcastlingB
	notendcastlingB10:
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si-3],al
	mov ds:[bx][si],ah
	mov cx,0f4f4h
	mov bx,0f4h 
	mov si,0f4h
	push cx bx si   
	call lastmove
	pop co co co
	pop si bx 
	mov ds:[bx][si-2],ah 
	mov ds:[bx][si],al 
	mov ah,0a5h
	mov ds:[bx][si-4],al
	mov ds:[bx][si-1],ah
	mov bx,offset castleB
	mov ax,1 
	mov ds:[bx],ax 
	jmp endeverysituation
	endcastlingB:
	pop si bx  		 
	jmp everysituationplayer2A 
	everysituationqueenb:
	push bx si 
	mov ax,0 
	inc di  
	loopqueenbe:
	dec di 
	cmp di,0 
	jnz c1queenbe
	call everysituationcheckblack
	c1queenbe:
	cmp ax,1
	jz queenbeoption1
	cmp ax,2
	jz queenbeoption2
	cmp ax,3
	jz queenbeoption3
	inc si
	add bx,length1
	cmp si,length1
	jnc cqueenbe		
	cmp bx,offset aEnd1
	jnc cqueenbe
	jmp queenbebegin1
	queenbeoption1: 
	add bx,length1
	sub si,1
	jc cqueenbe
	cmp bx,offset aEnd1
	jnc cqueenbe
	jmp queenbebegin1
	queenbeoption2:
	inc si
	sub bx,length1
	cmp si,length1
	jnc cqueenbe
	cmp bx,offset beginoff
	jc cqueenbe
	jmp queenbebegin1
	queenbeoption3:
	sub si,1
	jc cqueenbe
	sub bx,length1
	cmp bx,offset beginoff
	jc cqueenbe
	queenbebegin1:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz loopqueenbe
	cmp dl,10h
	jnc cqueenbe
	dec di 
	cmp di,0 
	jnz cqueenbe
	call everysituationcheckblack
	cqueenbe:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endqueenbe
	inc di 
	jmp loopqueenbe
	endqueenbe :	
	pop si bx
	push bx si
	mov ax,0 	   
	inc di   
	loopqueenbea:
	dec di 
	cmp di,0 
	jnz c1queenbea
	call everysituationcheckblack
	c1queenbea:
	cmp ax,1
	jz queenbeaoption1
	cmp ax,2
	jz queenbeaoption2
	cmp ax,3
	jz queenbeaoption3
	inc si
	cmp si,length1
	jnc cqueenbea
	jmp beginqueenbea
	queenbeaoption1:
	cmp si,0
	jz cqueenbea
	sub si,1 
	jmp beginqueenbea
	queenbeaoption2:
	add bx,length1
	cmp bx,offset aEnd1
	jnc cqueenbea 
	jmp beginqueenbea
	queenbeaoption3:
	sub bx,length1
	cmp bx,offset beginoff
	jc cqueenbea
	beginqueenbea:
	mov dl,ds:[si][bx]
	cmp dl,0
	jz loopqueenbea
	cmp dl,10h
	jnc cqueenbea
	dec di 
	cmp di,0 
	jnz cqueenbea
	call everysituationcheckblack 
	cqueenbea:		
	pop si bx
	push bx si 
	inc ax
	cmp ax,4
	jz endqueenbea
	inc di 
	jmp loopqueenbea
	endqueenbea :	
	pop si bx 
	jmp everysituationplayer2A 

	endeverysituation:
	pop si di dx cx bx ax  
	pop bp 
	ret	 
everysituation endp                                   
; -----------------------------------------------------------------------------------------------
everysituationcheckwhite proc 
      push ax 
	  mov ax,si
      add ax,bx	  
	  pop co cx si bx 
      push bx si cx co
	  add bx,si 
	  mov si,ax 
	  mov ch,ds:[si]
	  mov cl,ds:[bx]
	  mov ds:[si],cl
	  mov al,0 
	  mov ds:[bx],al
	  push co 
      call checkW
      pop ax 
      cmp ax,0 
	  jnz notendeverysituation1
	  sub bx,offset chessboard
	  sub si,offset chessboard
	  push cx bx si   
	  call lastmove
	  pop co co co
	  pop co si bx 
	  pop ax 
	  jmp endeverysituation
	notendeverysituation1:
	      mov ds:[bx],cl 
		  mov ds:[si],ch
		  inc di 
		  sub bx,si 
		  pop ax 
	ret 
everysituationcheckwhite endp   ;fix 
; -----------------------------------------------------------------------------------------------
everysituationcheckblack proc    
	      push ax                   
	      mov ax,si 
		  add ax,bx 
		  pop co cx si bx 
	      push bx si cx  co
		  add bx,si 
		  mov si,ax 
	      mov cl,ds:[bx]
		  mov ch,ds:[si]
		  mov ds:[si],cl
		  mov al,0 
		  mov ds:[bx],al  
		  push co 
	      call checkB
	      pop ax 
	      cmp ax,0 
		  jnz notendeverysituation
		  sub bx,offset chessboard
		  sub si,offset chessboard
		  push cx bx si 
		  call lastmove
		  pop co co co 
		  pop co si bx 
		  pop ax 
		  jmp endeverysituation
	      notendeverysituation:
		  mov ds:[bx],cl 
		  mov ds:[si],ch 
		  inc di  
	      sub bx,si 
		  pop ax 
	      ret 
everysituationcheckblack endp   ;fix 
; -----------------------------------------------------------------------------------------------
valueboard proc 
	push bp
	mov bp,sp
	push bx si cx  
	mov cx,32767
	mov si, offset chessboard
	loopvalueboard: 
	   mov bh,ds:[si]
	   cmp bh,01h
	   jnz Cv
	   add cx,100               ;pawn
	   Cv:
	   cmp bh,02h
	   jnz Cv1
	   add cx,325              ;bishop
	   Cv1:
	   cmp bh,03h
	   jnz Cv2
	   add cx,325              ;knight
	   Cv2:
	   cmp bh,05h
	   jnz Cv3
	   add cx,500              ;rook             
	   Cv3:
	   cmp bh,08h
	   jnz Cv4
	   add cx,1050              ;queen
	   Cv4:
	   cmp bh,0a1h
	   jnz Cvb
	   sub cx,100
	   Cvb:
	   cmp bh,0a2h
	   jnz Cv1b
	   sub cx,325
	   Cv1b:
	   cmp bh,0a3h
	   jnz Cv2b
	   sub cx,325
	   Cv2b:
	   cmp bh,0a5h
	   jnz Cv3b
	   sub cx,500
	   Cv3b:
	   cmp bh,0a8h
	   jnz Cv4b
	   sub cx,1050
	   Cv4b:
	   inc si 
	   cmp si, offset aEnd1
	   jc loopvalueboard
	   mov bx,0
	   push co 
	   call checkmatedrawW
	   pop bx 
	   cmp bx,0ffh
	   jnz Cv5
	   sub cx,10500
	Cv5:
	   mov bx,0
	   push co 
	   call checkmatedrawB
	   pop bx 
	   cmp bx,0ffh
	   jnz Cv5b
	   add cx,10500
	Cv5b:   
	    mov si,offset castle
		mov bx,ds:[si]
		cmp bx,1
	    jnz Cv6
	    add cx,50    
	Cv6:	
	    mov si,offset castleB
		mov bx,ds:[si]
		cmp bx,1
	    jnz Cv6B
	    sub cx,50
	Cv6B:	
		mov ss:[bp+4],cx
		pop cx si bx 
	    pop bp 	
		ret 
valueboard endp   ;change king ti checkmate
; -----------------------------------------------------------------------------------------------
MaxUpdate proc 
	push si bx ax 
	mov bx,offset chessboardAIMax 
	mov si,offset chessboard
	loopMaxUpdate:
	mov al,ds:[si]
	mov ds:[bx],al 
	inc bx 
	inc si
	cmp si,offset aEnd1
	jc loopMaxUpdate
	pop ax bx si 
	ret 
MaxUpdate endp
; -----------------------------------------------------------------------------------------------
MinUpdate proc 
	push si bx ax 
	mov bx,offset chessboardAIMin 
	mov si,offset chessboard
	loopMinUpdate:
	mov al,ds:[si]
	mov ds:[bx],al 
	inc bx 
	inc si
	cmp si,offset aEnd1
	jc loopMinUpdate
	pop ax bx si 
	ret 
MinUpdate endp
; -----------------------------------------------------------------------------------------------		
alphabeta proc
	push bp
	mov bp,sp	   
	push ax bx cx dx si di 	
	mov si,ss:[bp+4]                 ; depth
	mov ax,ss:[bp+6]                 ; alpha      = -∞      12767   
	mov bx,ss:[bp+8]                 ; beta       = ∞       52767  
	mov dx,ss:[bp+10]                ; 1 or 0 maximizingPlayer
	mov cx,ss:[bp+12]	            ;value   
	mov dl,1
	push dx                 
	call everysituation                  
	pop dx                         
	cmp dl,0ffh
	jz return1
	call undolastmove
	cmp si,0 
	jnz return
	return1:
	push co 
	call valueboard 
	pop cx    
	jmp endalphabeta            
	return: 
	cmp dh,0 
	jz player2
	mov di,12767                           ;max player -white  
	player1:  
	push dx                  ;    push co dx  
	call everysituation                  
	pop dx                         ;  pop dx co 	  
	cmp dl,0ffh
	jnz notendalphabeta	
	jmp endalphabeta
	notendalphabeta:
	sub si,1 
	mov dh,0
	push cx dx bx ax si                      
	call alphabeta                   ;cx value 
	mov cx,ss:[bp-6]
	mov si,ss:[bp+4]  		
	cmp di,cx 
	jnc maxfunction 
	cmp di,cx 
	jz maxfunction
	mov di,cx 
	call MaxUpdate
	maxfunction:
	cmp di,ax
	jnc maxfunction1
	cmp di,ax
	jz maxfunction1 		
	mov ax,di 
	maxfunction1:
	cmp ax,bx 
	jz endalphabeta
	cmp ax,bx 
	jnc endalphabeta                   ;return cx 
	inc dl
	jmp player1
	player2:     
	mov di,52767                   ;min player -black
	player2a:	      	           
	push dx                  ;    push co dx  
	call everysituation                  
	pop dx                         ;  pop dx co 	  
	cmp dl,0ffh
	jnz notendalphabeta1
	jmp endalphabeta
	notendalphabeta1:				    	 
	sub si,1
	mov dh,1      
	push cx dx bx ax si
	call alphabeta   
	mov si,ss:[bp+4]  
	mov cx,ss:[bp-6]			
	cmp di,cx 		
	jc minfunction 
	cmp di,cx
	jz minfunction         
	mov di,cx 
	call MinUpdate		
	minfunction:
	cmp di,bx
	jc minfunction1 
	cmp di,bx
	jz minfunction1          
	mov bx,di 
	minfunction1:
	cmp ax,bx 
	jz endalphabeta
	cmp ax,bx 
	jnc endalphabeta 
	inc dl 		 
	jmp player2a
	endalphabeta:   
	call undolastmove
	mov ss:[bp+20],cx   	
	pop di si dx cx bx ax 
	pop bp  	
	ret 10                        ;(number) remove from stack  
alphabeta endp ;fix 
;-----------------------------------------------------------------------------------------------
DrawUpdate proc 
	push si bx ax  
	mov bx,offset chessboard2
	mov si,offset chessboardAImax
	loopDrawUpdate:
	mov al,ds:[si]
	mov ds:[bx],al 
	inc bx 
	inc si
	cmp bx,offset aEnd2
	jc loopDrawUpdate
	pop ax bx si 
	ret 
DrawUpdate endp
;-----------------------------------------------------------------------------------------------
DrawUpdate1 proc 
	push si bx ax  
	mov bx,offset chessboard2
	mov si,offset chessboardAIMin
	loopDrawUpdate1:
	mov al,ds:[si]
	mov ds:[bx],al 
	inc bx 
	inc si
	cmp bx,offset aEnd2
	jc loopDrawUpdate1
	pop ax bx si 
	ret 
DrawUpdate1 endp
;-----------------------------------------------------------------------------------------------
undolastmove proc
	push ax bx cx si
	mov bx,offset chessmove
	sub bx,2 
	loopundolastmove:
	add bx,2
	mov ax,ds:[bx]
	cmp ax,0
	jnz loopundolastmove
	sub bx,2  
	mov si,ds:[bx]
	mov cx,0
	mov ds:[bx],cx
	cmp si,0f1f1h
	jz undocastle
	cmp si,0f2f2h
	jz undocastle1
	cmp si,0f3f3h
	jnz notundocastle2
	jmp undocastle2
	notundocastle2:
	cmp si,0f4f4h
	jnz notundocastle3
	jmp undocastle3
	notundocastle3:
	sub bx,offset chessmove
	add bx,offset chessmovepieces
	mov ax,ds:[bx]
	mov cx,0
	mov ds:[bx],cx
	mov bx,si
	and bx,0ffh
	and si,0ff00h
	mov cl,8
	ror si,cl
	add si,offset chessboard
	add bx,offset chessboard
	cmp ax,0f5f5h
	jnz notundoenpassantwhite
	jmp undoenpassantwhite
	notundoenpassantwhite:
	cmp ax,0f6f6h
	jnz notundoenpassantblack
	jmp undoenpassantblack
	notundoenpassantblack:
	mov ds:[si],ah
	mov ds:[bx],al
	jmp endundolastmove
	undocastle:
	mov bx,10A5h
	mov si,4h
	mov ah,9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si+2],al
	mov ah,05h
	mov ds:[bx][si+3],ah
	mov ds:[bx][si+1],al
	mov bx,offset castle
	mov ax,0
	mov ds:[bx],ax 
	jmp endundolastmove
	undocastle1:
	mov bx,10A5h
	mov si,4h
	mov ah,09h
	mov al,0 
	mov ds:[bx][si-2],al
	mov ds:[bx][si],ah 
	mov ah,05h
	mov ds:[bx][si-4],ah
	mov ds:[bx][si-1],al
	mov bx,offset castle
	mov ax,0
	mov ds:[bx],ax 
	jmp endundolastmove
	undocastle2:
	mov bx,1065h
	mov si,4h
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si],ah
	mov ds:[bx][si+2],al
	mov ah,0a5h
	mov ds:[bx][si+3],ah
	mov ds:[bx][si+1],al
	mov bx,offset castleB
	mov ax,0
	mov ds:[bx],ax 
	jmp endundolastmove
	undocastle3:
	mov bx,1065h
	mov si,4h
	mov ah,0a9h
	mov al,0 
	mov ds:[bx][si-2],al
	mov ds:[bx][si],ah 
	mov ah,0a5h
	mov ds:[bx][si-4],ah
	mov ds:[bx][si-1],al
	mov bx,offset castleB
	mov ax,0
	mov ds:[bx],ax 
	jmp endundolastmove
	undoenpassantwhite:
	mov al,1h
	mov ah,0h
	mov ds:[si],ah
	mov ds:[bx],al 
	mov ah,0a1h
	mov ds:[si+length1],ah	  
	jmp endundolastmove
	undoenpassantblack:
	mov al,0a1h
	mov ah,0h
	mov ds:[si],ah
	mov ds:[bx],al 
	mov ah,01h
	mov ds:[si-length1],ah	
	endundolastmove: 
	pop si cx bx ax
	ret 
undolastmove endp ;add2
;-----------------------------------------------------------------------------------------------
lastmove proc
	push bp
	mov bp,sp	
	push ax bx cx si 
	mov si,ss:[bp+4]          ;--> positon1
	mov bx,ss:[bp+6]          ;--> positon2 
	mov ax,ss:[bp+8]          ;-->pieces 
	mov cl,8 
	and si,0ffh
	rol si,cl
	and bx,0ffh
	add si,bx 
	mov bx,offset chessmove
	dec bx 
	looplastmove:
	inc bx
	mov cx,ds:[bx]
	cmp cx,0
	jnz looplastmove
	mov ds:[bx],si
	sub bx,offset chessmove
	add bx,offset chessmovepieces
	mov ds:[bx],ax
	pop si cx bx ax
	pop bp 
	ret 
lastmove endp                                             
;-----------------------------------------------------------------------------------------------
checkmatedrawW proc
	push bp 
	mov bp,sp
	push ax dx 
	mov dx,0101h
	push dx 
	call everysituation
	pop dx 
	cmp dl,0ffh 
	jnz endcheckmatedraw
	push co 
	call checkW
	pop ax 
	cmp ax,1
	jz checkmate
	drawgame:
	mov ax,0fh 
	mov ss:[bp+4],ax
	jmp endcheckmatedraw1
	checkmate:
	mov ax,0ffh
	mov ss:[bp+4],ax
	jmp endcheckmatedraw1
	endcheckmatedraw:
	call undolastmove
	endcheckmatedraw1:
	pop dx ax
	pop bp 
	ret
checkmatedrawW endp                                         
;-----------------------------------------------------------------------------------------------
checkmatedrawB proc
		push bp 
		mov bp,sp
		push ax dx 
		mov dx,0001h
		push dx 
		call everysituation
		pop dx 
		cmp dl,0ffh 
		jnz endcheckmatedrawB
		push co 
		call checkB
		pop ax 
		cmp ax,1
		jz checkmateB
		drawgameB:
		mov ax,0fh 
		mov ss:[bp+4],ax
		jmp endcheckmatedrawB1
		checkmateB:
		mov ax,0ffh
		mov ss:[bp+4],ax
		jmp endcheckmatedrawB1
		endcheckmatedrawB:
		call undolastmove
		endcheckmatedrawB1:
		pop dx ax
		pop bp 
		ret
checkmatedrawB endp                                      
; -----------------------------------------------------------------------------------------------
;################################################################################################
; -----------------------------------------------------------------------------------------------
Begin:  
	mov ax, dseg
	mov ds,ax
	mov bx,offset whiteorblack       ;  1 black 0 white 
	mov si,offset chessboard        
    

	mov ah,7 
	int 21h   ;  Direct char read (STDIN), no echo 	

	cmp al,'c'  ; if char == 'c'
    mov al,12h   ; AL = video mode 	
	mov ah,0
	int 10h      ; Set video mode

	jz againstcomputer 
    




    call updateBoard

	loop1:	   
	call movefunction 
	call updateBoard

	mov di,ds:[bx]  ; if white turn 
	cmp di,0 	 
	jnz replace

	mov di,1         ;pass turn 
	mov ds:[bx],di
	jmp loop1

	replace:
	mov di,0         ;pass turn 
	mov ds:[bx],di
	;jmp therealend;
	jmp loop1  ;



	againstcomputer:
		call updateBoard
		call movefunction
		push co 
		call checkmatedrawB
		pop ax
		cmp ax,0fh
		jz printdraw 
		cmp ax,0ffh
		jz printwinW
		push 32767 0 52767 12767 5
		call alphabeta         
		;call NegaScout
		pop co co co co co 
		call DrawUpdate 
	    call updateBoard
		push co 
		call checkmatedrawW
		pop ax 
		cmp ax,0fh
		jz printdraw 
		cmp ax,0ffh
		jz printwinB
		jmp againstcomputer				
	printdraw:	
		jmp therealend
	printwinW:	
		jmp therealend
	printwinB:

	therealend:
	    mov ah, 4ch
		int 21h

cseg ends
end begin
; -----------------------------------------------------------------------------------------------
;################################################################################################
; -----------------------------------------------------------------------------------------------
